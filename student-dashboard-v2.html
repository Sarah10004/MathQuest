<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathQuest - í•™ìƒ ëŒ€ì‹œë³´ë“œ v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&display=swap');
        
        :root {
            /* í†¤ì•¤ë§¤ë„ˆ: ë°ì€ ê·¸ë ˆì´, íŒŒë‘/ë¯¼íŠ¸/í•‘í¬ í¬ì¸íŠ¸ */
            --bg: #f6f7f9;
            --card: #ffffff;
            --ink: #1f2937; /* slate-800 */
            --muted: #6b7280; /* slate-500 */
            --primary: #3663ff; /* blue */
            --mint: #3dd4c5; /* mint/teal */
            --pink: #ff6ab7; /* pink */
            --ring: rgba(54, 99, 255, .25);
            --chip: #eef2ff; /* soft indigo */
            --chip-ink: #374151;
            --chip-active: #dbeafe; /* light blue */
            --shadow: 0 8px 24px rgba(31,41,55,.08);
            --radius: 18px;
            --radius-sm: 12px;
            --radius-lg: 26px;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg);
            color: var(--ink);
        }
        
        .progress-bar {
            background: #eef2f7;
            border-radius: 9999px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--mint));
            border-radius: 9999px;
            transition: width 0.3s ease;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card-shadow {
            box-shadow: var(--shadow);
            border-radius: var(--radius);
        }
        
        .btn-primary {
            background: linear-gradient(90deg, var(--primary), var(--mint));
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 14px rgba(54, 99, 255, 0.25);
        }
        
        .btn-outline {
            border: 1px solid #e5e7eb;
            background: white;
            color: var(--ink);
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .btn-outline:hover {
            border-color: var(--primary);
            background: var(--chip);
        }
        
        .hover-scale {
            transition: transform 0.2s ease;
        }
        
        .hover-scale:hover {
            transform: scale(1.02);
        }
        
        /* ê²½ë§¤ íŠœí† ë¦¬ì–¼ ìŠ¤íƒ€ì¼ */
        .slide {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .slide.hidden {
            opacity: 0;
            transform: translateX(20px);
            pointer-events: none;
        }
        .slide.active {
            opacity: 1;
            transform: translateX(0);
        }
        .quiz-choice {
            transition: all 0.2s ease;
        }
        .quiz-choice:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .quiz-choice.correct {
            background: #dcfce7 !important;
            border-color: #22c55e !important;
            color: #166534 !important;
        }
        .quiz-choice.incorrect {
            background: #fef2f2 !important;
            border-color: #ef4444 !important;
            color: #991b1b !important;
        }
        .page-indicators .active {
            background: #3b82f6 !important;
            transform: scale(1.2) !important;
        }
        .page-indicators div {
            transition: all 0.3s ease;
        }
        
        /* ê²½ë§¤ íŠœí† ë¦¬ì–¼ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .tutorial-btn {
            position: relative;
            overflow: hidden;
        }
        .tutorial-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s ease;
        }
        .tutorial-btn:hover::before {
            left: 100%;
        }
        .tutorial-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }
        
        /* â€”â€” ê²½ë§¤ì¥ ë¼ì´ë¸Œ ì°¸ì—¬ì ì‹œê°í™” ìŠ¤íƒ€ì¼ â€”â€” */
        .seat-item {
            position: relative;
            width: 200px;
            margin: 0 8px;
            text-align: center;
        }
        
        .seat-item img {
            width: 160px;
            height: 160px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: transform 0.2s ease;
        }
        
        .seat-item img:hover {
            transform: scale(1.05);
        }
        
        .nameplate {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: -30px;
            background: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 500;
            color: #374151;
            border: 1px solid #e5e7eb;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .bubble {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: -28px;
            background: #111827;
            color: #fff;
            padding: 5px 9px;
            border-radius: 999px;
            font-size: 11px;
            box-shadow: 0 6px 14px rgba(17,23,41,.2);
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
        }
        
        .bubble.show {
            animation: popfade .9s ease;
        }
        
        @keyframes popfade {
            0% { opacity: 0; transform: translate(-50%,-8px) scale(.9); }
            25% { opacity: 1; transform: translate(-50%,0) scale(1); }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        .crown {
            position: absolute;
            right: -6px;
            top: -10px;
            font-size: 15px;
            transform: rotate(-10deg);
        }
        
        /* â€”â€” ê²½ë§¤ì‚¬ ì—°ë‹¨ â€”â€” */
        .auctioneer {
            position: relative;
            width: 150px;
            margin: 0 auto;
        }
        
        .podiumTop {
            width: 150px;
            height: 24px;
            background: #915b2d;
            border: 4px solid #000;
            border-bottom-width: 6px;
            border-radius: 10px 10px 0 0;
        }
        
        .podium {
            width: 150px;
            height: 60px;
            background: #c88f5a;
            border: 4px solid #000;
            border-top-width: 0;
            border-bottom-width: 10px;
            border-radius: 0 0 12px 12px;
            position: relative;
        }
        
        .podium .label {
            position: absolute;
            left: 16px;
            right: 16px;
            top: 14px;
            height: 28px;
            background: #fff;
            border: 4px solid #231f20;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
        }
        
        .gavel {
            position: absolute;
            right: -8px;
            top: -14px;
            font-size: 20px;
            transform: rotate(-20deg);
        }
        
        .auct-bubble {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: -46px;
            background: #111827;
            
        /* ìƒˆë¡œìš´ ì±…ìƒê³¼ ì˜ì ìŠ¤íƒ€ì¼ */
        .desk-chair {
            position: relative;
            width: 80px;
            height: 60px;
            margin: 0 8px;
        }
        
        .desk {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(135deg, #d97706, #f59e0b);
            border-radius: 8px 8px 4px 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .chair {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 20px;
            background: linear-gradient(135deg, #d97706, #f59e0b);
            border-radius: 4px 4px 0 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .student-avatar {
            position: absolute;
            bottom: 28px;
            left: 50%;
            transform: translateX(-50%);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            border: 2px solid white;
        }
        
        .nameplate {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 500;
            color: #374151;
            border: 1px solid #e5e7eb;
            white-space: nowrap;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .crown {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 16px;
            height: 16px;
            background: #fbbf24;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #92400e;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
            color: #fff;
            padding: 6px 10px;
            border-radius: 999px;
            font-size: 12px;
            opacity: 0;
        }
        
        .auct-bubble.show {
            animation: popfade 1s ease;
        }
        
        /* ìƒˆë¡œìš´ ë””ìì¸ ìš”ì†Œë“¤ */
        .soft-blob {
            position: relative;
            height: 4rem;
        }
        
        .blob-1 {
            position: absolute;
            left: -0.25rem;
            top: 0.25rem;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: #ffd5ef;
        }
        
        .blob-2 {
            position: absolute;
            left: 4rem;
            top: -0.25rem;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 40%;
            background: #cfe9ff;
            transform: rotate(12deg);
        }
        
        .blob-3 {
            position: absolute;
            left: 7rem;
            top: 1.5rem;
            width: 2rem;
            height: 2rem;
            border-radius: 14px;
            background: #b7f7ec;
        }
        
        .donut-chart {
            width: 9rem;
            height: 9rem;
            margin: 0 auto;
        }
        
        .floating-assistant {
            position: fixed;
            right: 1.25rem;
            bottom: 1.25rem;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            border: 2rem solid #e3f0ff;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            background: radial-gradient(circle at 30% 30%, #e2ebff, #f1fff9);
            display: grid;
            place-items: center;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .floating-assistant:hover {
            transform: scale(1.1);
        }
        
        .assistant-dot {
            width: 0.875rem;
            height: 0.875rem;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #3663ff, #3dd4c5, #ff6ab7, #3663ff);
        }

        /* Avatar Shop Styles */
        .avatar-category-btn {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            white-space: nowrap;
            border: 2px solid transparent;
        }

        .avatar-category-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .avatar-category-btn:not(.active) {
            background: white;
            color: var(--muted);
            border-color: #e5e7eb;
        }

        .avatar-category-btn:not(.active):hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .avatar-item {
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            padding: 16px;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .avatar-item:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(54, 99, 255, 0.15);
        }

        .avatar-item.selected {
            border-color: var(--primary);
            background: #f0f4ff;
        }

        .avatar-item.owned {
            border-color: #10b981;
            background: #f0fdf4;
        }

        /* ì§„í–‰ ì¤‘ ê³¼ì œ ì¹´ë“œ ê³ ë„í™” ìŠ¤íƒ€ì¼ */
        .chip {
            --c: #e2e8f0;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.45rem 0.8rem;
            border-radius: 999px;
            font-weight: 700;
            background: #fff;
            box-shadow: 0 6px 16px rgba(15,23,42,.06);
            border: 1px solid var(--c);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .chip[data-amber] {
            --c: #f59e0b40;
            background: linear-gradient(180deg,#fff7ed,#fff);
            border-color: #f59e0b40;
        }
        .chip[data-ghost] {
            background: transparent;
            border-color: #e5e7eb;
        }
        .chip:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(15,23,42,.1);
        }
        .seg {
            position: relative;
            height: 20px;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(156, 163, 175, 0.3);
            box-shadow: none;
        }
        .seg-fill {
            position: absolute;
            inset: 0 auto 0 0;
            width: 100%;
            background: linear-gradient(90deg, #8B5CF6, #6366F1, #22D3EE);
            box-shadow: 0 0 12px rgba(34, 211, 238, .45);
            transition: width 0.9s cubic-bezier(.2,.9,.2,1);
            border-radius: 8px;
        }
        .seg-icon {
            position: absolute;
            left: 6px;
            top: 50%;
            transform: translate(0, -50%);
            opacity: 0.9;
        }
        .seg.done {
            background: transparent;
            box-shadow: none;
        }
        .seg.done .seg-fill {
            background: linear-gradient(90deg, #34D399, #10B981);
            box-shadow: 0 0 12px rgba(34, 211, 238, .45);
            border-radius: 8px;
        }
        .kpi {
            font-size: 28px;
            font-weight: 900;
            letter-spacing: -0.02em;
            color: #1e293b;
        }

        .avatar-item.locked {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .avatar-item.locked:hover {
            transform: none;
            box-shadow: none;
        }
    </style>
</head>
<body class="min-h-screen" style="background: var(--bg);">
    <div class="p-6 pb-24">
        <!-- Header -->
        <header class="flex items-center justify-between mb-6">
            <h1 class="text-xl font-bold" style="color: var(--primary);">MathQuest</h1>
            <div class="flex items-center space-x-4">
                <a href="https://polypad.amplify.com/p#polygons" target="_blank" class="group">
                    <div class="relative">
                        <img src="assets/icon_geoboard.svg" class="w-7 h-7 text-indigo-600 group-hover:text-indigo-700 transition-colors duration-200" alt="ì§€ì˜¤ë³´ë“œ ìˆ˜í•™ êµêµ¬">
                        <!-- ê°•ì¡° íš¨ê³¼ -->
                        <div class="absolute inset-0 bg-indigo-100 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 -z-10 scale-150"></div>
                        <!-- íˆ´íŒ -->
                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-indigo-600 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap">
                            ìˆ˜í•™ êµêµ¬
                            <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-indigo-600"></div>
                        </div>
                    </div>
                </a>
                <div class="w-9 h-9 bg-indigo-200 rounded-full"></div>
            </div>
        </header>

        <!-- Hero / Summary Cards -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            <!-- Left: Avatar + Greeting -->
            <div class="card-shadow bg-white">
                <div class="p-6">
                    <div class="flex items-start justify-between">
                        <!-- Student Avatar -->
                        <div class="mr-6 flex flex-col items-center">
                            <div class="relative">
                                <div class="w-48 h-48 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center shadow-lg border-4 border-white">
                                    <img src="assets/tennis_pet_transparent.svg" class="w-24 h-24" alt="í…Œë‹ˆìŠ¤ í« ì•„ë°”íƒ€">
                                </div>
                                <div class="absolute -bottom-1 -right-1 w-6 h-6 bg-green-400 rounded-full border-2 border-white flex items-center justify-center">
                                    <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                </div>
                                <button class="absolute bottom-0 right-0 w-8 h-8 bg-blue-500 hover:bg-blue-600 rounded-full border-2 border-white flex items-center justify-center shadow-lg transition-colors" onclick="openAvatarShop()" title="ì•„ë°”íƒ€ ë³€ê²½">
                                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                    </svg>
                                </button>
                            </div>
                            <p class="text-[12px] font-medium text-slate-700 mt-2">ì§€ë¯¼</p>
                        </div>
                        
                        <div class="flex-1">
                            <h2 class="text-[20px] font-extrabold leading-snug">
                                ì§€ë¯¼ì˜ ì˜¤ëŠ˜ ê³¼ì œëŠ” <span style="color: var(--primary);">ê°œìˆ˜ ì„¸ê¸°</span>ì˜ˆìš”. 1ë‹¨ì› <span style="color: var(--primary);">ë‹¨ì› í‰ê°€</span>ì— ì‘ì‹œí•˜ì„¸ìš”.
                            </h2>
                            <p class="text-[13px] text-slate-600 mt-3">
                                ì§§ê³  ì§‘ì¤‘ë˜ëŠ” ì¹´ë“œí˜• ê³¼ì œì™€ ê²Œì„í˜• ì—°ìŠµìœ¼ë¡œ ëª°ì…ì„ ë†’ì—¬ë³¼ê¹Œìš”?
                            </p>

                            <!-- soft blobs for playful tone -->
                            <div class="soft-blob mt-4">
                                <div class="blob-1"></div>
                                <div class="blob-2"></div>
                                <div class="blob-3"></div>
                            </div>

                            <div class="mt-4 flex flex-wrap gap-6 text-[13px] text-slate-700">
                                <div class="space-y-1">
                                    <p class="text-slate-500">ì˜¤ëŠ˜ì˜ ê³¼ì œ</p>
                                    <p class="text-lg font-extrabold">2ê°œ</p>
                                </div>
                                <div class="space-y-1">
                                    <p class="text-slate-500">í¬ì¸íŠ¸</p>
                                    <p class="text-lg font-extrabold text-yellow-500">1,240</p>
                                </div>
                                <div class="space-y-1">
                                    <p class="text-slate-500">ì•„ì´í…œ</p>
                                    <p class="text-lg font-extrabold text-pink-500">7ê°œ</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: Progress stats -->
            <div class="grid grid-cols-1 gap-3">
                <div class="card-shadow bg-gradient-to-br from-[#4f6bff] to-[#2850ff] border-0">
                    <div class="p-4">
                        <!-- Header -->
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                            <div class="flex items-center gap-2">
                                <h3 class="text-[14px] font-extrabold text-white">ì§„í–‰ ì¤‘ ê³¼ì œ</h3>
                                <span id="totalPct" class="ml-2 text-blue-200 font-extrabold text-[10px]">(3ê°œ ì¤‘ ì§„í–‰ë¥  50%)</span>
                            </div>
                            <div class="inline-flex rounded-2xl bg-white/15 p-1 backdrop-blur">
                                <button data-tab="today"
                                        class="task-tab-btn px-2.5 py-1 text-xs font-bold rounded-xl
                                               bg-white text-blue-700 shadow
                                               transition-colors" id="f-today" role="button" aria-pressed="true">
                                    ì˜¤ëŠ˜
                                </button>
                                <button data-tab="week"
                                        class="task-tab-btn px-2.5 py-1 text-xs font-bold rounded-xl
                                               text-white/90 hover:bg-white/10 transition-colors" id="f-week" role="button">
                                    ì´ë²ˆ ì£¼
                                </button>
                                <button data-tab="all"
                                        class="task-tab-btn px-2.5 py-1 text-xs font-bold rounded-xl
                                               text-white/90 hover:bg-white/10 transition-colors" id="f-all" role="button">
                                    ì „ì²´
                                </button>
                            </div>
                        </div>

                        <!-- Progress bar -->
                        <div class="mt-4">
                            <div class="relative">
                                <div class="h-2 bg-slate-200 rounded-full overflow-hidden">
                                    <div id="main-progress-bar" class="h-full bg-gradient-to-r from-blue-500 to-teal-400 rounded-full transition-all duration-500" style="width: 50%"></div>
                                </div>
                            </div>
                            <!-- legend -->
                            <div class="mt-2 flex items-center gap-4 text-[10px] text-white">
                                <span class="inline-flex items-center gap-2">
                                    <span class="inline-block w-2.5 h-2.5 rounded bg-gradient-to-r from-blue-500 to-teal-400"></span> ì§„í–‰ë¥ 
                                </span>
                            </div>
                        </div>

                        <!-- Footer: up next + CTA -->
                        <div class="mt-4 flex flex-col gap-3">
                            <div id="upnext" class="flex items-center gap-3">
                                <div class="w-7 h-7 rounded-lg bg-blue-100 grid place-items-center text-blue-600 text-xs">â–¶</div>
                                <div>
                                    <div class="text-[10px] text-blue-200">Up next</div>
                                    <div class="font-bold text-white text-xs" id="nextTitle">ëƒì…ˆ ì—°ìŠµ</div>
                                    <div class="h-0.5 w-28 bg-blue-200 rounded mt-1 overflow-hidden">
                                        <div id="nextBar" class="h-full bg-gradient-to-r from-blue-400 to-blue-500" style="width:70%"></div>
                                    </div>
                                </div>
                                <span id="nextEta" class="chip ml-2" data-ghost>ì˜ˆìƒ <b class="ml-1">5</b>ë¶„</span>
                                <div class="ml-2 px-3 py-1 bg-gradient-to-r from-yellow-400 to-orange-400 rounded-full text-[9px] font-bold text-white shadow-sm">
                                    ë³´ìƒ <b>50P</b>
                                </div>
                            </div>
                            <div class="flex justify-end">
                                <div class="flex items-center gap-1.5">
                                    <button id="btnContinue" class="px-2 py-1 rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold text-[9px] shadow hover:from-blue-700">ì´ì–´í•˜ê¸°</button>
                                    <button id="btnAll" class="px-2 py-1 rounded-lg border-2 border-blue-200 font-bold text-white text-[9px] hover:bg-blue-500/20">ì „ì²´ ë³´ê¸°</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-shadow border-0 bg-gradient-to-br from-[#3dd4c5] to-[#20b3a5] text-white">
                    <div class="p-4">
                        <!-- í—¤ë”: ì œëª© + íƒ­ -->
                        <div class="flex items-center justify-between gap-3">
                            <h2 class="text-[15px] font-extrabold tracking-tight">í‰ê°€ ì‘ì‹œ í˜„í™©</h2>

                            <!-- íƒ­ -->
                            <div class="inline-flex rounded-2xl bg-white/15 p-1 backdrop-blur">
                                <button data-tab="today"
                                        class="eval-tab-btn px-2.5 py-1 text-xs font-bold rounded-xl
                                               bg-white text-teal-700 shadow
                                               transition-colors">
                                    ì˜¤ëŠ˜
                                </button>
                                <button data-tab="week"
                                        class="eval-tab-btn px-2.5 py-1 text-xs font-bold rounded-xl
                                               text-white/90 hover:bg-white/10 transition-colors">
                                    ì´ë²ˆ ì£¼
                                </button>
                                <button data-tab="all"
                                        class="eval-tab-btn px-2.5 py-1 text-xs font-bold rounded-xl
                                               text-white/90 hover:bg-white/10 transition-colors">
                                    ì „ì²´
                                </button>
                            </div>
                        </div>

                        <!-- ì¹© ìš”ì•½ -->
                        <div class="mt-3 flex flex-wrap items-center gap-2">
                            <!-- ì‘ì‹œìœ¨ -->
                            <div class="chip flex items-center gap-1.5 bg-white/90 text-slate-800 rounded-lg px-2.5 py-1">
                                <span class="inline-flex w-2 h-2 rounded-full bg-emerald-500"></span>
                                <span class="text-[10px] font-semibold text-slate-500">ì‘ì‹œìœ¨</span>
                                <strong id="rate" class="text-xs font-extrabold">70%</strong>
                            </div>
                            <!-- í‰ê·  ì ìˆ˜ -->
                            <div class="chip flex items-center gap-1.5 bg-white/90 text-slate-800 rounded-lg px-2.5 py-1">
                                <span class="inline-flex w-2 h-2 rounded-full bg-sky-500"></span>
                                <span class="text-[10px] font-semibold text-slate-500">í‰ê· </span>
                                <strong id="avg" class="text-xs font-extrabold">84ì </strong>
                            </div>
                            <!-- ë¯¸ì‘ì‹œ -->
                            <div class="chip flex items-center gap-1.5 bg-white/90 text-slate-800 rounded-lg px-2.5 py-1">
                                <span class="inline-flex w-2 h-2 rounded-full bg-rose-500"></span>
                                <span class="text-[10px] font-semibold text-slate-500">ë¯¸ì‘ì‹œ</span>
                                <strong id="miss" class="text-xs font-extrabold">2ê±´</strong>
                            </div>
                            <!-- ë§ˆê° ì„ë°• -->
                            <div class="chip flex items-center gap-1.5 bg-white/90 text-slate-800 rounded-lg px-2.5 py-1">
                                <span class="inline-flex w-2 h-2 rounded-full bg-amber-500"></span>
                                <span class="text-[10px] font-semibold text-slate-500">ë§ˆê° ì„ë°•</span>
                                <strong id="due" class="text-xs font-extrabold">1ê±´</strong>
                            </div>

                            <!-- ë”ë³´ê¸° ë²„íŠ¼ -->
                            <button
                                class="ml-auto inline-flex items-center gap-1 bg-white/15 hover:bg-white/25 text-white
                                       border border-white/20 rounded-lg px-2.5 py-1 text-xs font-bold transition-colors">
                                ë”ë³´ê¸°
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                     class="opacity-90">
                                    <path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="2"
                                          stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Second row: ìµœê·¼ í•™ìŠµ ì£¼ì œ ë¹„ì¤‘, ì˜¤ëŠ˜ì˜ ê³¼ì œ, ë‚´ í•™ìŠµ í« -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
            <!-- ìµœê·¼ í•™ìŠµ ì£¼ì œ ë¹„ì¤‘ -->
            <div class="card-shadow bg-white">
                <div class="p-5">
                    <div class="flex items-start justify-between">
                        <div>
                            <h3 class="text-[14px] font-bold">ìµœê·¼ í•™ìŠµ ì£¼ì œ ë¹„ì¤‘</h3>
                            <p class="text-[11px] text-slate-500 mt-1">ì§€ë‚œ 7ì¼ ê¸°ì¤€</p>
                        </div>
                        <button class="btn-outline h-7 text-[11px] rounded-xl">ë¦¬í¬íŠ¸</button>
                    </div>
                    <div class="mt-3 grid grid-cols-2 gap-3 items-center">
                        <svg viewBox="0 0 42 42" class="donut-chart">
                            <circle cx="21" cy="21" r="15.915" fill="none" stroke="#eef2ff" stroke-width="6" />
                            <!-- blue 40% -->
                            <circle cx="21" cy="21" r="15.915" fill="none" stroke="#4f6bff" stroke-width="6" stroke-dasharray="40 60" stroke-dashoffset="25" />
                            <!-- mint 35% -->
                            <circle cx="21" cy="21" r="15.915" fill="none" stroke="#3dd4c5" stroke-width="6" stroke-dasharray="35 65" stroke-dashoffset="-15" />
                            <!-- pink 25% -->
                            <circle cx="21" cy="21" r="15.915" fill="none" stroke="#ff6ab7" stroke-width="6" stroke-dasharray="25 75" stroke-dashoffset="-55" />
                        </svg>
                        <div class="text-[12px] space-y-2">
                            <div class="flex items-center gap-2"><span class="w-2.5 h-2.5 rounded-full bg-[#4f6bff] flex-shrink-0"></span><span>ë¶„ìˆ˜ 40%</span></div>
                            <div class="flex items-center gap-2"><span class="w-2.5 h-2.5 rounded-full bg-[#3dd4c5] flex-shrink-0"></span><span>ë„í˜• 35%</span></div>
                            <div class="flex items-center gap-2"><span class="w-2.5 h-2.5 rounded-full bg-[#ff6ab7] flex-shrink-0"></span><span>ì—°ì‚° 25%</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì˜¤ëŠ˜ì˜ ê³¼ì œ -->
            <div class="card-shadow bg-white">
                <div class="p-5">
                    <div class="flex items-center justify-between">
                        <h3 class="text-[14px] font-semibold">ì˜¤ëŠ˜ì˜ ê³¼ì œ</h3>
                        <button class="btn-outline h-7 text-[11px] rounded-xl">ëª¨ë‘ ë³´ê¸°</button>
                    </div>
                    <div class="mt-3 space-y-4">
                        <div class="flex items-center justify-between gap-4">
                            <div class="min-w-0">
                                <p class="font-medium text-[13px] truncate">ëƒì…ˆ ì—°ìŠµ</p>
                                <div class="progress-bar w-32 h-2 mt-1">
                                    <div class="progress-fill" style="width: 70%"></div>
                                </div>
                            </div>
                            <button class="btn-outline text-[12px] rounded-xl" onclick="openBalloonAdditionGame()">
                                ì´ì–´í•˜ê¸° 
                                <svg class="w-4 h-4 ml-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="flex items-center justify-between gap-4">
                            <div class="min-w-0">
                                <p class="font-medium text-[13px] truncate">ê°œìˆ˜ ì„¸ê¸° í€´ì¦ˆ</p>
                                <div class="progress-bar w-32 h-2 mt-1">
                                    <div class="progress-fill" style="width: 20%"></div>
                                </div>
                            </div>
                            <button class="btn-outline text-[12px] rounded-xl" onclick="startCountingGame()">
                                ì‹œì‘í•˜ê¸° 
                                <svg class="w-4 h-4 ml-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë‚´ í•™ìŠµ í« -->
            <div class="card-shadow bg-gradient-to-r from-pink-50 to-yellow-50">
                <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="text-[14px] font-semibold">ë‚´ í•™ìŠµ í«</h3>
                            <p class="text-slate-600 text-[12px]">ì—´ì‹¬íˆ ê³µë¶€í•´ì„œ í«ì„ ì„±ì¥ì‹œì¼œìš”!</p>
                        </div>
                        <div class="w-16 h-16 bg-gradient-to-br from-pink-200 to-yellow-200 rounded-full flex items-center justify-center animate-pulse">
                            <svg class="w-8 h-8 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                            </svg>
                        </div>
                    </div>
                                     <div class="flex justify-end">
                     <button onclick="openPetStudio()" class="bg-gradient-to-r from-pink-400 to-yellow-400 hover:from-pink-500 hover:to-yellow-500 text-white text-[16px] font-semibold px-6 py-3 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105">
                         Pet Studio
                     </button>
                 </div>
                </div>
            </div>
        </div>



        <!-- Recommended Section -->
        <div class="mt-8">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-extrabold bg-gradient-to-r from-purple-600 via-pink-500 to-red-500 bg-clip-text text-transparent mb-2">
                    âœ¨ ë‚˜ì—ê²Œ ê¼­ ë§ëŠ” ì¶”ì²œ í•™ìŠµ ìë£ŒëŠ”? âœ¨
                </h3>
                <div class="w-24 h-1 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full mx-auto"></div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="card-shadow bg-white hover-scale">
                    <div class="p-5">
                        <div class="text-[11px] text-slate-500 mb-1">AI ì¶”ì²œ</div>
                        <p class="font-semibold text-[14px] mb-1">ì—°ì‚° ì±Œë¦°ì§€</p>
                        <p class="text-[12px] text-slate-600">ì§§ê³  ë¹ ë¥´ê²Œ ì—°ì‚°ë ¥ì„ í‚¤ì›Œë³´ì„¸ìš”</p>
                        <div class="mt-3 flex flex-wrap gap-2">
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">ë°ì¼ë¦¬</span>
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">ì—°ì‚°</span>
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">í€˜ìŠ¤íŠ¸</span>
                        </div>
                    </div>
                </div>
                <div class="card-shadow bg-white hover-scale">
                    <div class="p-5">
                        <div class="text-[11px] text-slate-500 mb-1">AI ì¶”ì²œ</div>
                        <p class="font-semibold text-[14px] mb-1">ë„í˜• íƒí—˜</p>
                        <p class="text-[12px] text-slate-600">ì¬ë¯¸ìˆëŠ” ë„í˜• í€˜ìŠ¤íŠ¸ì— ë„ì „í•˜ì„¸ìš”</p>
                        <div class="mt-3 flex flex-wrap gap-2">
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">ë„í˜•</span>
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">íƒêµ¬</span>
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">í¼ì¦</span>
                        </div>
                    </div>
                </div>
                <div class="card-shadow bg-white hover-scale">
                    <div class="p-5">
                        <div class="text-[11px] text-slate-500 mb-1">AI ì¶”ì²œ</div>
                        <p class="font-semibold text-[14px] mb-1">ë¶„ìˆ˜ í¼ì¦</p>
                        <p class="text-[12px] text-slate-600">ë¶„ìˆ˜ ê°œë…ì„ ë†€ì´ì²˜ëŸ¼ ì—°ìŠµí•˜ê¸°</p>
                        <div class="mt-3 flex flex-wrap gap-2">
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">ë¶„ìˆ˜</span>
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">í¼ì¦</span>
                            <span class="text-[11px] px-2 py-1 rounded-full bg-[#eef2ff] text-slate-700">ê¸°ì´ˆ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Market Section -->
        <div class="mt-8">
            <!-- Header with balance -->
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center gap-3">
                    <h3 class="text-2xl font-extrabold bg-gradient-to-r from-blue-600 via-indigo-500 to-purple-600 bg-clip-text text-transparent">
                        ğŸ›ï¸ ë¦¬ì›Œë“œ ë§ˆì¼“
                    </h3>
                    <div class="w-16 h-1 bg-gradient-to-r from-blue-400 to-purple-400 rounded-full"></div>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="mb-4 flex gap-2 items-center">
                <button class="btn-primary rounded-xl text-[12px] px-4 py-2" id="shop-tab" onclick="switchTab('shop')">ìƒì </button>
                <button class="btn-outline rounded-xl text-[12px] px-4 py-2" id="auction-tab" onclick="switchTab('auction')">ê²½ë§¤ì¥</button>
                <span class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-4 py-2 rounded-2xl shadow-lg flex items-center gap-2">
                    <div class="w-5 h-5 bg-white/20 rounded-full flex items-center justify-center">
                        <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                    </div>
                    <span class="font-bold text-sm">ë‚´ í¬ì¸íŠ¸ 1,240P</span>
                </span>
                <div class="ml-auto text-[12px] text-slate-600">ì¸ë²¤í† ë¦¬: <span id="inventory-count">0</span>ê°œ</div>
            </div>

            <!-- Shop Tab Content -->
            <div id="shop-content" class="space-y-4">
                <!-- Search and Filters -->
                <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                    <div class="flex flex-col md:flex-row gap-2 w-full md:w-auto">
                        <div class="relative w-full md:w-64">
                            <input type="text" id="search-input" placeholder="ì•„ì´í…œ ê²€ìƒ‰" class="w-full pl-8 pr-3 py-2 text-[13px] border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            <svg class="w-4 h-4 text-slate-400 absolute left-2.5 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                        <select id="category-filter" class="w-full md:w-32 text-[13px] border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="ì „ì²´">ì „ì²´</option>
                            <option value="ì½”ìŠ¤ë©”í‹±">ì½”ìŠ¤ë©”í‹±</option>
                            <option value="í«" selected>í«</option>
                            <option value="í•™ìŠµ">í•™ìŠµ</option>
                        </select>
                        <select id="rarity-filter" class="w-full md:w-36 text-[13px] border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="ì „ì²´" selected>ì „ì²´</option>
                            <option value="COMMON">COMMON</option>
                            <option value="RARE">RARE</option>
                            <option value="EPIC">EPIC</option>
                            <option value="SEASONAL">SEASONAL</option>
                        </select>
                        <select id="sort-filter" class="w-full md:w-28 text-[13px] border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="popular" selected>ì¸ê¸°</option>
                            <option value="price_asc">ê°€ê²©â†‘</option>
                            <option value="price_desc">ê°€ê²©â†“</option>
                            <option value="new">ìµœì‹ </option>
                        </select>
                    </div>
                </div>

                <!-- Shop Items Grid -->
                <div class="card-shadow bg-white">
                    <div class="p-5">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-2">
                                <svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                                </svg>
                                <h4 class="text-[14px] font-semibold">ìƒì </h4>
                                <span class="text-[11px] text-slate-500" id="shop-item-count">9ê°œ</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="shop-items-grid">
                            <!-- Shop items will be populated by JavaScript -->
                        </div>

                        <!-- Pagination -->
                        <div class="flex items-center justify-center gap-2 mt-5">
                            <button class="btn-outline text-[12px] rounded-xl px-3 py-1" id="prev-page" onclick="changePage(-1)">ì´ì „</button>
                            <span class="text-[12px] text-slate-600" id="page-info">1 / 1</span>
                            <button class="btn-outline text-[12px] rounded-xl px-3 py-1" id="next-page" onclick="changePage(1)">ë‹¤ìŒ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Auction Tab Content -->
            <div id="auction-content" class="space-y-4" style="display: none;">
                <div class="flex items-center justify-between">
                    <div class="text-[12px] text-slate-600">í•™ê¸‰ ì „ìš© ê²½ë§¤ Â· ì±„íŒ… ì—†ìŒ Â· ì‹ ê³ /ì°¨ë‹¨ ìš´ì˜</div>
                </div>

                <div class="card-shadow bg-white">
                    <div class="p-5">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-3">
                                <svg class="w-4 h-4 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <h4 class="text-[14px] font-semibold">ê²½ë§¤ì¥</h4>
                                <button class="tutorial-btn flex items-center gap-2 text-[12px] text-blue-600 hover:text-blue-700 font-medium bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 px-3 py-1.5 rounded-lg transition-all duration-200 border border-blue-200 hover:border-blue-300 shadow-sm hover:shadow-md" onclick="openAuctionTutorial()" title="ê²½ë§¤ íŠœí† ë¦¬ì–¼">
                                    <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    ê²½ë§¤ íŠœí† ë¦¬ì–¼
                                </button>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="auction-items-grid">
                            <!-- Auction items will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- ë¼ì´ë¸Œ ì°¸ì—¬ì ì‹œê°í™” -->
                <div class="card-shadow bg-white">
                    <div class="p-5">
                        <div class="mb-3 flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <svg class="w-4 h-4 text-pink-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                <h4 class="text-[14px] font-semibold">ë¼ì´ë¸Œ ì°¸ì—¬ì</h4>
                                <span id="leader-name" class="ml-2 text-[12px] text-slate-500">í˜„ì¬ ìµœê³  ì…ì°°ì: ê¶Œí¬ì¤€</span>
                            </div>
                        </div>

                        <div class="relative overflow-hidden rounded-[24px]" style="background:#fef4e6">
                            <!-- ìƒë‹¨ ë°°ê²½ -->
                            <div class="h-18 border-b border-amber-200 bg-[url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%2272%22><rect width=%22400%22 height=%2272%22 fill=%22%23fde7c7%22/><rect x=%22180%22 y=%2210%22 width=%22100%22 height=%2236%22 fill=%22%23dff1ff%22/><rect x=%22310%22 y=%2220%22 width=%2250%22 height=%2236%22 fill=%22none%22 stroke=%22%23f1d3a8%22 stroke-width=%223%22/></svg>')]"></div>

                            <!-- ì¢Œì„ 5ê°œ: ìƒˆë¡œìš´ ì¢Œì„ ì´ë¯¸ì§€ë¡œ ë°°ì¹˜ -->
                            <div class="px-6 md:px-12 pt-8">
                                <div id="seats" class="flex justify-between gap-6 md:gap-10 flex-wrap md:flex-nowrap">
                                    <!-- JSê°€ ì‚½ì… -->
                                </div>
                            </div>

                            <!-- ê²½ë§¤ì‚¬ ìë¦¬: ì¤‘ì•™ ì „ë©´ -->
                            <div class="pb-10 pt-6 flex justify-center">
                                <div class="auctioneer">
                                    <div class="auct-bubble" id="auct-bubble">ë”©ë™! ì…ì°° ì§„í–‰</div>
                                    <div class="podiumTop"></div>
                                    <div class="podium">
                                        <div class="label">ê²½ë§¤ì‚¬</div>
                                        <div class="gavel">ğŸ”¨</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Avatar Shop Modal -->
        <div id="avatar-shop-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-2">
            <div class="bg-white rounded-2xl p-4 max-w-[95vw] w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-3">
                        <h3 class="text-lg font-bold text-slate-800">ì•„ë°”íƒ€ ìƒì </h3>
                        <div class="flex items-center gap-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full px-3 py-1.5 text-white font-bold text-sm shadow-sm">
                            <div class="w-5 h-5 bg-white/20 rounded-full flex items-center justify-center">
                                <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                </svg>
                            </div>
                            <span>ë‚´ í¬ì¸íŠ¸ <span id="avatar-shop-points">1,240P</span></span>
                        </div>
                    </div>
                    <button class="text-gray-500 hover:text-gray-700" onclick="closeAvatarShop()">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Avatar Categories -->
                <div class="flex gap-2 mb-4 overflow-x-auto pb-2">
                    <button class="avatar-category-btn active" data-category="all">ì „ì²´</button>
                    <button class="avatar-category-btn" data-category="free">ë¬´ë£Œ</button>
                    <button class="avatar-category-btn" data-category="premium">í”„ë¦¬ë¯¸ì—„</button>
                    <button class="avatar-category-btn" data-category="seasonal">ì‹œì¦Œí•œì •</button>
                </div>

                <!-- Avatar Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4 mb-4" id="avatar-grid">
                    <!-- Avatars will be populated by JavaScript -->
                </div>

                <!-- Current Avatar Display -->
                <div class="border-t pt-4">
                    <h4 class="text-base font-semibold mb-3">í˜„ì¬ ì•„ë°”íƒ€</h4>
                    <div class="flex items-center gap-4">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center shadow-lg border-4 border-white overflow-hidden">
                            <img src="assets/tennis_pet_transparent.svg" class="w-16 h-16" alt="í…Œë‹ˆìŠ¤ í« ì•„ë°”íƒ€">
                        </div>
                        <div>
                            <p class="font-medium text-slate-800">ê¸°ë³¸ ì•„ë°”íƒ€</p>
                            <p class="text-sm text-slate-600">í˜„ì¬ ì°©ìš© ì¤‘</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Avatar Purchase Modal -->
        <div id="avatar-purchase-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-gradient-to-br from-pink-100 via-yellow-100 to-mint-100 rounded-2xl p-4 max-w-sm w-full mx-4 shadow-xl border-2 border-pink-300 relative overflow-hidden">
                <!-- ë°°ê²½ ì¥ì‹ -->
                <div class="absolute top-0 right-0 w-16 h-16 bg-gradient-to-br from-pink-200 to-purple-200 rounded-full opacity-30 -translate-y-8 translate-x-8"></div>
                <div class="absolute bottom-0 left-0 w-12 h-12 bg-gradient-to-br from-mint-200 to-blue-200 rounded-full opacity-30 translate-y-6 -translate-x-6"></div>
                
                <div class="relative z-10 text-center">
                    <!-- ì´ëª¨ì§€ì™€ ì œëª© -->
                    <div class="text-3xl mb-2 animate-bounce">ğŸ›ï¸âœ¨</div>
                    <h3 class="text-lg font-extrabold text-indigo-800 mb-3 bg-gradient-to-r from-pink-500 to-purple-600 bg-clip-text text-transparent">
                        ì•„ë°”íƒ€ êµ¬ë§¤ í™•ì¸
                    </h3>
                    
                    <!-- ì•„ë°”íƒ€ ì •ë³´ -->
                    <div class="bg-white rounded-xl p-3 mb-3 shadow-lg border-2 border-pink-200">
                        <div class="flex items-center justify-center gap-3 mb-3">
                            <div id="purchase-avatar-image" class="w-12 h-12 rounded-full flex items-center justify-center shadow-lg border-3 border-white overflow-hidden">
                                <!-- ì•„ë°”íƒ€ ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                            </div>
                            <div class="text-left">
                                <h4 id="purchase-avatar-name" class="text-sm font-bold text-indigo-800"></h4>
                                <p class="text-xs text-gray-600">ìƒˆë¡œìš´ ì•„ë°”íƒ€!</p>
                            </div>
                        </div>
                        
                        <!-- ê°€ê²© ì •ë³´ -->
                        <div class="bg-gradient-to-r from-amber-100 to-yellow-100 rounded-lg p-3 border-2 border-amber-200">
                            <div class="flex items-center justify-center gap-1 mb-1">
                                <span class="text-lg">ğŸª™</span>
                                <span class="text-xs font-medium text-amber-700">ê°€ê²©</span>
                            </div>
                            <p class="text-xl font-extrabold text-amber-600" id="purchase-avatar-price"></p>
                        </div>
                    </div>
                    
                    <!-- í™•ì¸ ë©”ì‹œì§€ -->
                    <div class="bg-gradient-to-r from-pink-200 to-purple-200 rounded-xl p-3 mb-3">
                        <p class="text-sm font-bold text-indigo-800">
                            ì´ ì•„ë°”íƒ€ë¥¼ êµ¬ë§¤í•˜ì‹œê² ì–´ìš”? ğŸ‰
                        </p>
                    </div>
                    
                    <!-- ë²„íŠ¼ -->
                    <div class="flex gap-2 justify-center">
                        <button onclick="closeAvatarPurchaseModal()" 
                                class="bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg transform hover:scale-105 transition-all duration-200 border-2 border-gray-300">
                            âŒ ì·¨ì†Œ
                        </button>
                        <button onclick="confirmAvatarPurchase()" 
                                class="bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white px-4 py-2 rounded-xl font-bold text-sm shadow-lg transform hover:scale-105 transition-all duration-200 border-2 border-pink-300">
                            ğŸ¯ êµ¬ë§¤í•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg flex justify-around py-3 z-50">
        <button class="flex flex-col items-center" style="color: var(--primary);">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
            </svg>
            <span class="text-xs mt-1">í™ˆ</span>
        </button>
        <button class="flex flex-col items-center text-gray-600 transition-colors" style="--tw-text-opacity: 1; color: var(--muted);" onmouseover="this.style.color='var(--primary)'" onmouseout="this.style.color='var(--muted)'">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
            </svg>
            <span class="text-xs mt-1">ê³¼ì œ</span>
        </button>
        <button class="flex flex-col items-center text-gray-600 transition-colors" style="--tw-text-opacity: 1; color: var(--muted);" onmouseover="this.style.color='var(--primary)'" onmouseout="this.style.color='var(--muted)'">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
            </svg>
            <span class="text-xs mt-1">í‰ê°€</span>
        </button>
        <button class="flex flex-col items-center text-gray-600 transition-colors" style="--tw-text-opacity: 1; color: var(--muted);" onmouseover="this.style.color='var(--primary)'" onmouseout="this.style.color='var(--muted)'">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
            </svg>
            <span class="text-xs mt-1">ë°˜</span>
        </button>
        <button class="flex flex-col items-center text-gray-600 transition-colors" style="--tw-text-opacity: 1; color: var(--muted);" onmouseover="this.style.color='var(--primary)'" onmouseout="this.style.color='var(--muted)'">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"></path>
            </svg>
            <span class="text-xs mt-1">ë¦¬ì›Œë“œ</span>
        </button>
        <button class="flex flex-col items-center text-gray-600 transition-colors" style="--tw-text-opacity: 1; color: var(--muted);" onmouseover="this.style.color='var(--primary)'" onmouseout="this.style.color='var(--muted)'">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
            </svg>
            <span class="text-xs mt-1">ë¶„ì„</span>
        </button>
        <button class="flex flex-col items-center text-gray-600 transition-colors" style="--tw-text-opacity: 1; color: var(--muted);" onmouseover="this.style.color='var(--primary)'" onmouseout="this.style.color='var(--muted)'">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <span class="text-xs mt-1">ì„¤ì •</span>
        </button>
    </nav>

    <!-- Floating Assistant -->
    <button class="floating-assistant" title="AI ë„ì›€ë§" onclick="showAIAssistant()">
        <div class="assistant-dot"></div>
    </button>



    <script>
        // í•™ìƒìš© ëŒ€ì‹œë³´ë“œ v2 ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
        document.addEventListener('DOMContentLoaded', function() {
            // ì¹´ë“œë“¤ì´ ìˆœì°¨ì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” íš¨ê³¼
            const cards = document.querySelectorAll('.card-shadow');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });

            // ì§„í–‰ë¥  ë°” ì• ë‹ˆë©”ì´ì…˜
            const progressBars = document.querySelectorAll('.progress-fill');
            progressBars.forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.width = width;
                }, 800);
            });

            // í†µê³„ ì¹´ë“œ í˜¸ë²„ íš¨ê³¼
            const statCards = document.querySelectorAll('.hover-scale');
            statCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.02)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                });
            });

            // ë²„íŠ¼ í´ë¦­ íš¨ê³¼
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 150);
                });
            });
        });

        // AI ë„ìš°ë¯¸ í‘œì‹œ í•¨ìˆ˜
        function showAIAssistant() {
            alert('AI ë„ìš°ë¯¸ê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?');
        }

        // ì˜¨ë³´ë”© ë°ì´í„° í™•ì¸ ë° í‘œì‹œ
        function checkOnboardingData() {
            const onboardingData = localStorage.getItem('onboarding_answers');
            if (onboardingData) {
                try {
                    const data = JSON.parse(onboardingData);
                    console.log('ì˜¨ë³´ë”© ë°ì´í„°:', data);
                    
                    // ì˜¨ë³´ë”© ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ UI ì—…ë°ì´íŠ¸
                    updateDashboardWithOnboardingData(data);
                } catch (e) {
                    console.error('ì˜¨ë³´ë”© ë°ì´í„° íŒŒì‹± ì˜¤ë¥˜:', e);
                }
            }
        }

        // ì˜¨ë³´ë”© ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        function updateDashboardWithOnboardingData(data) {
            // ì˜ˆì‹œ: í•™ë…„ ì •ë³´ê°€ ìˆìœ¼ë©´ í‘œì‹œ
            if (data.grade && data.grade.length > 0) {
                const gradeInfo = data.grade.join(', ');
                // í•™ë…„ ì •ë³´ë¥¼ UIì— ë°˜ì˜í•˜ëŠ” ë¡œì§
                console.log('í•™ë…„ ì •ë³´:', gradeInfo);
            }
            
            // ê°•ì  ì •ë³´ê°€ ìˆìœ¼ë©´ ì¶”ì²œ ì„¹ì…˜ì— ë°˜ì˜
            if (data.strength && data.strength.length > 0) {
                const strengths = data.strength.join(', ');
                console.log('ê°•ì  ì •ë³´:', strengths);
            }
        }

        // ê²½ë§¤ì¥ ì¹´ìš´íŠ¸ë‹¤ìš´ ê¸°ëŠ¥
        function updateAuctionTimers() {
            const now = Date.now();
            
            // ê²½ë§¤ 1: 6ì‹œê°„ í›„ ì¢…ë£Œ
            const auction1End = now + (6 * 60 * 60 * 1000);
            const timeLeft1 = Math.max(0, auction1End - now);
            const hours1 = Math.floor(timeLeft1 / (1000 * 60 * 60));
            const minutes1 = Math.floor((timeLeft1 % (1000 * 60 * 60)) / (1000 * 60));
            const seconds1 = Math.floor((timeLeft1 % (1000 * 60)) / 1000);
            
            const timer1 = document.getElementById('auction1-timer');
            if (timer1) {
                timer1.textContent = `${String(hours1).padStart(2, '0')}:${String(minutes1).padStart(2, '0')}:${String(seconds1).padStart(2, '0')}`;
            }
            
            // ê²½ë§¤ 2: 20ë¶„ í›„ ì¢…ë£Œ
            const auction2End = now + (20 * 60 * 1000);
            const timeLeft2 = Math.max(0, auction2End - now);
            const hours2 = Math.floor(timeLeft2 / (1000 * 60 * 60));
            const minutes2 = Math.floor((timeLeft2 % (1000 * 60 * 60)) / (1000 * 60));
            const seconds2 = Math.floor((timeLeft2 % (1000 * 60)) / 1000);
            
            const timer2 = document.getElementById('auction2-timer');
            if (timer2) {
                timer2.textContent = `${String(hours2).padStart(2, '0')}:${String(minutes2).padStart(2, '0')}:${String(seconds2).padStart(2, '0')}`;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì˜¨ë³´ë”© ë°ì´í„° í™•ì¸
        window.addEventListener('load', checkOnboardingData);
        
        // ë§ˆì¼“ ì‹œìŠ¤í…œ ë°ì´í„° ë° ìƒíƒœ
        let currentBalance = 1240;
        let inventory = [];
        let currentTab = 'shop';
        let currentPage = 1;
        const PAGE_SIZE = 9;

                     // ëª©ë°ì´í„°
             const MOCK_ITEMS = [
                 { id: 11, title: "ë°°ê²½ í…Œë§ˆ Â· ìŠ¤ë…¸ìš°", price: 400, category: "ì½”ìŠ¤ë©”í‹±", rarity: "SEASONAL", tag: "ì‹œì¦Œ", image: "/img/bg_snow.png", popularity: 80, createdAt: 1730000000000 },
                 { id: 12, title: "íŒíŠ¸ í‹°ì¼“ Ã—3", price: 250, category: "í•™ìŠµ", rarity: "COMMON", tag: "í•™ìŠµ", image: "/img/ticket.png", popularity: 92, createdAt: 1731000000000 },
                 { id: 13, title: "í« ë¨¹ì´ Â· ë³„ì‚¬íƒ•", price: 120, category: "í«", rarity: "COMMON", tag: "í«", image: "/img/candy.png", popularity: 76, createdAt: 1732000000000 },
                 { id: 14, title: "ê·€ì—¬ìš´ í‘¸ë“¤", price: 520, category: "í«", rarity: "RARE", tag: "ìŠ¤í‚¨", image: "/img/skin_mint.png", popularity: 88, createdAt: 1733000000000 },
                 { id: 15, title: "í”„ë¡œí•„ ì´í™íŠ¸ Â· í•‘í¬ ì˜¤ë¼", price: 680, category: "ì½”ìŠ¤ë©”í‹±", rarity: "EPIC", tag: "íš¨ê³¼", image: "/img/effect_pink.png", popularity: 70, createdAt: 1733500000000 },
                 { id: 16, title: "ë°°ê²½ í…Œë§ˆ Â· ë„¤ì˜¨", price: 420, category: "ì½”ìŠ¤ë©”í‹±", rarity: "RARE", tag: "í…Œë§ˆ", image: "/img/bg_neon.png", popularity: 64, createdAt: 1733600000000 },
                 { id: 17, title: "ë³´ë„ˆìŠ¤ í•´ì„¤ íŒ¨ìŠ¤(1ì¼)", price: 300, category: "í•™ìŠµ", rarity: "RARE", tag: "í•´ì„¤", image: "/img/pass_explain.png", popularity: 85, createdAt: 1733700000000 },
                 { id: 18, title: "í« ì¥ë‚œê° Â· ìš”ìš”", price: 160, category: "í«", rarity: "COMMON", tag: "ì¥ë‚œê°", image: "/img/toy_yoyo.png", popularity: 55, createdAt: 1733800000000 },
                 { id: 19, title: "ë¬¸ì œ ìƒì„± í† í°(10)", price: 540, category: "í•™ìŠµ", rarity: "EPIC", tag: "AI", image: "/img/ai_tokens.png", popularity: 99, createdAt: 1733900000000 },
             ];

        const MOCK_AUCTIONS = [
            {
                id: 101,
                title: "í¬ê·€ Â· í•‘í¬ ì˜¤ë¼ ì´í™íŠ¸",
                current: 820,
                buyout: 2400,
                minInc: 50,
                rare: true,
                image: "/img/effect_pink.png",
                endsAt: Date.now() + 1000 * 60 * 38, // 38ë¶„
                leader: "ê¶Œí¬ì¤€"
            },
            {
                id: 102,
                title: "í« ìŠ¤í‚¨ Â· ë¯¼íŠ¸ ìŠ¬ë¼ì„",
                current: 540,
                buyout: 1800,
                minInc: 50,
                rare: false,
                image: "/img/skin_mint.png",
                endsAt: Date.now() + 1000 * 60 * 60 * 6, // 6ì‹œê°„
                leader: "ë°•ì²­ëª…"
            },
        ];

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchTab(tab) {
            currentTab = tab;
            currentPage = 1;
            
            // íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë³€ê²½
            document.getElementById('shop-tab').className = tab === 'shop' ? 'btn-primary rounded-xl text-[12px] px-4 py-2' : 'btn-outline rounded-xl text-[12px] px-4 py-2';
            document.getElementById('auction-tab').className = tab === 'auction' ? 'btn-primary rounded-xl text-[12px] px-4 py-2' : 'btn-outline rounded-xl text-[12px] px-4 py-2';
            
            // ì½˜í…ì¸  í‘œì‹œ/ìˆ¨ê¹€
            document.getElementById('shop-content').style.display = tab === 'shop' ? 'block' : 'none';
            document.getElementById('auction-content').style.display = tab === 'auction' ? 'block' : 'none';
            
            // í•´ë‹¹ íƒ­ì˜ ë°ì´í„° ë Œë”ë§
            if (tab === 'shop') {
                renderShopItems();
            } else {
                renderAuctionItems();
                renderSeats();
            }
        }

        // ìƒì  ì•„ì´í…œ ë Œë”ë§
        function renderShopItems() {
            const searchQuery = document.getElementById('search-input').value.toLowerCase();
            const categoryFilter = document.getElementById('category-filter').value;
            const rarityFilter = document.getElementById('rarity-filter').value;
            const sortFilter = document.getElementById('sort-filter').value;
            
            // í•„í„°ë§
            let filtered = MOCK_ITEMS.filter(item => {
                if (searchQuery && !item.title.toLowerCase().includes(searchQuery)) return false;
                if (categoryFilter !== 'ì „ì²´' && item.category !== categoryFilter) return false;
                if (rarityFilter !== 'ì „ì²´' && item.rarity !== rarityFilter) return false;
                return true;
            });
            
            // ì •ë ¬
            switch (sortFilter) {
                case 'price_asc':
                    filtered.sort((a, b) => a.price - b.price);
                    break;
                case 'price_desc':
                    filtered.sort((a, b) => b.price - a.price);
                    break;
                case 'new':
                    filtered.sort((a, b) => b.createdAt - a.createdAt);
                    break;
                default:
                    filtered.sort((a, b) => b.popularity - a.popularity);
            }
            
            // í˜ì´ì§€ë„¤ì´ì…˜
            const totalPages = Math.ceil(filtered.length / PAGE_SIZE);
            const startIndex = (currentPage - 1) * PAGE_SIZE;
            const pageData = filtered.slice(startIndex, startIndex + PAGE_SIZE);
            
                         // ì•„ì´í…œ ê·¸ë¦¬ë“œ ë Œë”ë§
             const grid = document.getElementById('shop-items-grid');
             grid.innerHTML = pageData.map(item => {
                 // í« ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜
                 function getPetImage(title) {
                     if (title.includes('ê·€ì—¬ìš´ í‘¸ë“¤')) {
                         // í‘¸ë“¤ ì´ë¯¸ì§€
                         return `<div class="w-16 h-16 rounded-full bg-gradient-to-br from-amber-200 to-orange-300 flex items-center justify-center">
                             <img src="assets/poodle.svg" class="w-14 h-14" alt="ê·€ì—¬ìš´ í‘¸ë“¤">
                         </div>`;
                     } else if (title.includes('ë³„ì‚¬íƒ•')) {
                         // í« ë¨¹ì´(ë³„ì‚¬íƒ•+ê·¸ë¦‡) ì´ë¯¸ì§€
                         return `<div class="w-16 h-16 rounded-full bg-gradient-to-br from-pink-200 to-purple-300 flex items-center justify-center">
                             <img src="assets/pet_food.svg" class="w-14 h-14" alt="í« ë¨¹ì´">
                         </div>`;
                     } else if (title.includes('ìš”ìš”')) {
                         // í« ì¥ë‚œê°(ìš”ìš”) ì´ë¯¸ì§€
                         return `<div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-200 to-cyan-300 flex items-center justify-center">
                             <img src="assets/pet_toy.svg" class="w-14 h-14" alt="í« ì¥ë‚œê°">
                         </div>`;
                     } else if (title.includes('í«')) {
                         // ê¸°íƒ€ í« ì•„ì´í…œ - ê¸°ë³¸ í•˜íŠ¸ ì´ë¯¸ì§€
                         return `<div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-200 to-indigo-300 flex items-center justify-center">
                             <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                             </svg>
                         </div>`;
                     }
                     
                     // ê¸°ë³¸ ì•„ì´í…œ ì´ë¯¸ì§€ (ë²ˆê°œ ì•„ì´ì½˜)
                     return `<div class="h-28 rounded-xl bg-gradient-to-br from-[#eef2ff] to-white flex items-center justify-center">
                         <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                         </svg>
                     </div>`;
                 }
                 
                 return `
                     <div class="rounded-2xl border border-indigo-50 p-3 bg-[#fbfcff]">
                         ${getPetImage(item.title)}
                         <p class="mt-2 text-[12px] font-semibold truncate" title="${item.title}">${item.title}</p>
                         <div class="mt-1 flex items-center justify-between">
                             <span class="text-[12px] font-bold text-indigo-700">${item.price}P</span>
                             <div class="flex items-center gap-1">
                                 <span class="text-[10px] px-2 py-1 rounded-md bg-[#eef2ff] text-slate-700">${item.tag}</span>
                                 <span class="text-[10px] px-2 py-1 rounded-md ${item.rarity !== 'COMMON' ? 'bg-pink-500 text-white' : 'bg-gray-100 text-gray-700'}">${item.rarity}</span>
                             </div>
                         </div>
                         <button class="btn-primary w-full mt-2 text-[12px] rounded-xl" onclick="openPurchaseModal(${item.id})">êµ¬ë§¤</button>
                     </div>
                 `;
             }).join('');
            
            // í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
            document.getElementById('shop-item-count').textContent = `${filtered.length}ê°œ`;
            document.getElementById('page-info').textContent = `${currentPage} / ${totalPages}`;
            document.getElementById('prev-page').disabled = currentPage === 1;
            document.getElementById('next-page').disabled = currentPage === totalPages;
        }

        // ê²½ë§¤ ì•„ì´í…œ ë Œë”ë§
        function renderAuctionItems() {
            const grid = document.getElementById('auction-items-grid');
            grid.innerHTML = MOCK_AUCTIONS.map(auction => {
                const timeLeft = Math.max(0, auction.endsAt - Date.now());
                const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                const timeDisplay = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                
                return `
                    <div class="rounded-2xl border border-pink-50 p-3 bg-[#fff8fb]">
                        <div class="flex items-center gap-3">
                            <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-[#ffe3f2] to-white flex items-center justify-center">
                                <svg class="w-6 h-6 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <div class="min-w-0 flex-1">
                                <div class="flex items-center gap-2">
                                    <p class="text-[12px] font-semibold truncate" title="${auction.title}">${auction.title}</p>
                                    ${auction.rare ? '<span class="bg-pink-500 text-white text-[10px] px-2 py-1 rounded-md">í¬ê·€</span>' : ''}
                                </div>
                                <div class="mt-1 flex items-center gap-2 text-[11px] text-slate-600">
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                                    </svg>
                                    í˜„ì¬ê°€ <b class="text-slate-900">${auction.current}P</b>
                                    <span class="opacity-60">/</span> ì¦‰êµ¬ <b class="text-slate-900">${auction.buyout}P</b>
                                </div>
                                <div class="mt-1 flex items-center gap-2 text-[11px] text-slate-600">
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    ë‚¨ì€ ì‹œê°„ <b class="text-slate-900">${timeDisplay}</b>
                                </div>
                            </div>
                        </div>
                        <div class="mt-2 flex items-center gap-2">
                            <button class="btn-primary text-[12px] rounded-xl" onclick="bid(${auction.id})">ì…ì°° +${auction.minInc}P</button>
                            <button class="btn-outline text-[12px] rounded-xl" onclick="buyout(${auction.id})">ì¦‰ì‹œêµ¬ë§¤</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // í˜ì´ì§€ ë³€ê²½
        function changePage(delta) {
            currentPage = Math.max(1, currentPage + delta);
            renderShopItems();
        }

        // êµ¬ë§¤ ëª¨ë‹¬ ì—´ê¸°
        function openPurchaseModal(itemId) {
            const item = MOCK_ITEMS.find(i => i.id === itemId);
            if (!item) return;
            
            document.getElementById('modal-item-title').textContent = item.title;
            document.getElementById('modal-item-price').textContent = item.price;
            document.getElementById('modal-balance').textContent = currentBalance;
            document.getElementById('purchase-modal').classList.remove('hidden');
            document.getElementById('confirm-purchase').disabled = currentBalance < item.price;
        }

        // êµ¬ë§¤ ëª¨ë‹¬ ë‹«ê¸°
        function closePurchaseModal() {
            document.getElementById('purchase-modal').classList.add('hidden');
        }

        // êµ¬ë§¤ í™•ì¸
        function confirmPurchase() {
            const modal = document.getElementById('purchase-modal');
            const title = document.getElementById('modal-item-title').textContent;
            const price = parseInt(document.getElementById('modal-item-price').textContent);
            
            if (currentBalance < price) {
                alert('í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•´ìš”.');
                return;
            }
            
            currentBalance -= price;
            inventory.push({ id: Date.now(), title: title, price: price });
            
            updateBalanceDisplay();
            updateInventoryCount();
            closePurchaseModal();
            alert('êµ¬ë§¤ ì™„ë£Œ! ì¸ë²¤í† ë¦¬ì— ì¶”ê°€ë˜ì—ˆì–´ìš”.');
        }

        // ì…ì°°
        function bid(auctionId) {
            const auction = MOCK_AUCTIONS.find(a => a.id === auctionId);
            if (!auction) return;
            
            const nextBid = auction.current + auction.minInc;
            if (currentBalance < auction.minInc) {
                alert('í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•´ìš”.');
                return;
            }
            
            auction.current = nextBid;
            auction.leader = 'ë‚˜(ì§€ë¯¼)';
            currentBalance -= auction.minInc;
            updateBalanceDisplay();
            renderAuctionItems();
            renderSeats();
            updateLeader('ë‚˜(ì§€ë¯¼)');
            showBubble('me', 'ì…ì°°! +50');
            alert(`ì…ì°° ì™„ë£Œ! í˜„ì¬ê°€: ${nextBid}P`);
        }

        // ì¦‰ì‹œêµ¬ë§¤
        function buyout(auctionId) {
            const auction = MOCK_AUCTIONS.find(a => a.id === auctionId);
            if (!auction) return;
            
            if (currentBalance < auction.buyout) {
                alert('í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•´ìš”.');
                return;
            }
            
            auction.current = auction.buyout;
            auction.leader = 'ë‚˜(ì§€ë¯¼)';
            currentBalance -= auction.buyout;
            inventory.push({ id: Date.now(), title: auction.title, price: auction.buyout });
            
            updateBalanceDisplay();
            updateInventoryCount();
            renderSeats();
            updateLeader('ë‚˜(ì§€ë¯¼)');
            showBubble('me', 'ì¦‰ì‹œêµ¬ë§¤!');
            alert('ì¦‰ì‹œêµ¬ë§¤ ì™„ë£Œ! ì¸ë²¤í† ë¦¬ì— ì¶”ê°€ë˜ì—ˆì–´ìš”.');
        }

        // ì”ì•¡ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateBalanceDisplay() {
            document.getElementById('market-balance').textContent = `${currentBalance}P`;
        }

        // ì¸ë²¤í† ë¦¬ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        function updateInventoryCount() {
            document.getElementById('inventory-count').textContent = inventory.length;
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        document.addEventListener('DOMContentLoaded', function() {
            // ê²€ìƒ‰ ë° í•„í„° ì´ë²¤íŠ¸
            document.getElementById('search-input').addEventListener('input', () => {
                currentPage = 1;
                renderShopItems();
            });
            
            document.getElementById('category-filter').addEventListener('change', () => {
                currentPage = 1;
                renderShopItems();
            });
            
            document.getElementById('rarity-filter').addEventListener('change', () => {
                currentPage = 1;
                renderShopItems();
            });
            
            document.getElementById('sort-filter').addEventListener('change', () => {
                currentPage = 1;
                renderShopItems();
            });
            
            // ì´ˆê¸° ë Œë”ë§
            renderShopItems();
            updateInventoryCount();
            
            // ê²½ë§¤ì¥ íƒ­ì´ ì²˜ìŒ ë¡œë“œë  ë•Œ ì¢Œì„ ë Œë”ë§
            if (currentTab === 'auction') {
                renderSeats();
            }
        });

                 // ê²½ë§¤ì¥ íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ (1ì´ˆë§ˆë‹¤)
         setInterval(() => {
             if (currentTab === 'auction') {
                 renderAuctionItems();
             }
         }, 1000);
         
         // ë¼ì´ë¸Œ ì°¸ì—¬ì ë°ì´í„° (ìƒˆë¡œìš´ ì¢Œì„ ì´ë¯¸ì§€ êµ¬ì¡°)
         const participants = [
                     { id: 1, name: 'ì§€ë¯¼', seatImage: 'assets/seats/seat_1_jimin.svg', isLeader: false, isMe: true },
        { id: 2, name: 'ë°•ì²­ëª…', seatImage: 'assets/seats/seat_2_park.svg', isLeader: true, isMe: false },
        { id: 3, name: 'ê¹€ìˆ˜í˜¸', seatImage: 'assets/seats/seat_3_kim.svg', isLeader: false, isMe: false },
        { id: 4, name: 'ê¶Œí¬ì¤€', seatImage: 'assets/seats/seat_4_kwon.svg', isLeader: false, isMe: false },
        { id: 5, name: 'ë‚¨ìƒë¯¸', seatImage: 'assets/seats/seat_5_nam.svg', isLeader: false, isMe: false }
         ];
         
         // ì¢Œì„ ë Œë”ë§ (ìƒˆë¡œìš´ ì¢Œì„ ì´ë¯¸ì§€ êµ¬ì¡°)
         function renderSeats() {
             const seatsContainer = document.getElementById('seats');
             if (!seatsContainer) return;
             
             seatsContainer.innerHTML = participants.map(participant => `
                 <div class="seat-item">
                     <img src="${participant.seatImage}" class="w-40 h-40" alt="${participant.name} ì¢Œì„">
                     <div class="nameplate">
                         ${participant.id}ë²ˆ ${participant.isMe ? 'ë‚˜(' + participant.name + ')' : participant.name}
                         ${participant.isLeader ? '<div class="crown">ğŸ‘‘</div>' : ''}
                     </div>
                 </div>
             `).join('');
         }
         
         // ë§í’ì„  í‘œì‹œ (ìƒˆë¡œìš´ êµ¬ì¡°)
         function showBubble(participantId, message) {
             const participant = participants.find(p => p.id === participantId);
             if (!participant) return;
             
             const seat = document.querySelector(`#seats .seat-item:nth-child(${participantId})`);
             if (!seat) return;
             
             // ê¸°ì¡´ ë§í’ì„  ì œê±°
             const existingBubble = seat.querySelector('.bubble');
             if (existingBubble) {
                 existingBubble.remove();
             }
             
             // ìƒˆ ë§í’ì„  ìƒì„±
             const bubble = document.createElement('div');
             bubble.className = 'bubble';
             bubble.textContent = message;
             seat.appendChild(bubble);
             
             // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
             setTimeout(() => {
                 bubble.classList.add('show');
             }, 100);
             
             // ë§í’ì„  ì œê±°
             setTimeout(() => {
                 bubble.remove();
             }, 3000);
         }
         
         // ë¦¬ë” ì—…ë°ì´íŠ¸ (ìƒˆë¡œìš´ êµ¬ì¡°)
         function updateLeader(leaderName) {
             const leaderElement = document.getElementById('leader-name');
             if (leaderElement) {
                 leaderElement.textContent = `í˜„ì¬ ìµœê³  ì…ì°°ì: ${leaderName}`;
             }
             
             // ë¦¬ë” ìƒíƒœ ì—…ë°ì´íŠ¸
             participants.forEach(p => {
                 p.isLeader = p.name === leaderName;
             });
             
             // ì¢Œì„ ë‹¤ì‹œ ë Œë”ë§
             renderSeats();
         }
         
         // ë´‡ ìë™ ì…ì°° (ìƒˆë¡œìš´ êµ¬ì¡°)
         function randomBot() {
             const randomParticipant = participants[Math.floor(Math.random() * participants.length)];
             if (!randomParticipant.isMe) {
                 const messages = ['ì…ì°°!', 'ë” ë†’ê²Œ!', 'ë‚´ê°€ ê°€ì ¸ê°„ë‹¤!', 'í¥!'];
                 const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                 showBubble(randomParticipant.id, randomMessage);
             }
         }
         
         // ê²½ë§¤ 1 ë´‡ ìë™ ì…ì°°
         setInterval(() => {
             if (currentTab === 'auction' && MOCK_AUCTIONS[0].endsAt - Date.now() > 10_000 && Math.random() < 0.45) {
                 const randomParticipant = participants[Math.floor(Math.random() * participants.length)];
                 if (randomParticipant.isMe) return;
                 
                 const auction = MOCK_AUCTIONS[0];
                 auction.current += auction.minInc;
                 auction.leader = randomParticipant.name;
                 
                 renderAuctionItems();
                 renderSeats();
                 updateLeader(auction.leader);
                 showBubble(randomParticipant.id, 'ì…ì°°! +50');
             }
         }, 3600);
         
         // ê²½ë§¤ 2 ë´‡ ìë™ ì…ì°°
         setInterval(() => {
             if (currentTab === 'auction' && MOCK_AUCTIONS[1].endsAt - Date.now() > 10_000 && Math.random() < 0.35) {
                 const randomParticipant = participants[Math.floor(Math.random() * participants.length)];
                 if (randomParticipant.isMe) return;
                 
                 const auction = MOCK_AUCTIONS[1];
                 auction.current += auction.minInc;
                 auction.leader = randomParticipant.name;
                 
                 renderAuctionItems();
                 renderSeats();
                 updateLeader(auction.leader);
                 showBubble(randomParticipant.id, 'ì…ì°°! +50');
             }
         }, 5200);

         // ë„í˜•ì˜ ë„“ì´ í€´ì¦ˆ ì‹œì‘
         function startAreaQuest() {
             // í’€ìŠ¤í¬ë¦° ëª¨ë‹¬ ì—´ê¸°
             const modal = document.createElement('div');
             modal.id = 'area-quest-modal';
             modal.className = 'fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4';
             modal.innerHTML = `
                 <div class="bg-white rounded-3xl max-w-6xl w-full max-h-[95vh] overflow-hidden">
                     <!-- í—¤ë” -->
                     <div class="p-4 pb-0 border-b border-gray-100">
                         <div class="flex items-center justify-between w-full">
                             <div class="flex items-center gap-2 text-[13px]">
                                 <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">ë„í˜•ì˜ ë„“ì´</span>
                                 <span class="text-slate-600">1 / 10</span>
                             </div>
                             <button class="w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center" onclick="closeAreaQuest()">
                                 <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                 </svg>
                             </button>
                         </div>
                     </div>

                     <div class="px-4 pb-4">
                         <!-- ì§„í–‰ë¥  ë° íƒ€ì´ë¨¸ -->
                         <div class="flex items-center gap-3 mb-3 mt-3">
                             <div class="w-full">
                                 <div class="bg-gray-200 rounded-full h-2">
                                     <div class="bg-gradient-to-r from-indigo-500 to-mint-500 h-2 rounded-full transition-all duration-300" id="quest-progress" style="width: 10%"></div>
                                 </div>
                             </div>
                             <span class="text-[12px] text-slate-600" id="quest-timer">00:45</span>
                         </div>

                         <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
                         <div class="flex gap-2 mb-3">
                             <button class="bg-gradient-to-r from-indigo-500 to-mint-500 text-white px-4 py-2 rounded-xl text-[12px] font-medium" id="tiling-tab" onclick="switchQuestMode('tiling')">íƒ€ì¼ë§ ë©</button>
                             <button class="border border-gray-300 bg-white text-gray-700 px-4 py-2 rounded-xl text-[12px] font-medium" id="decompose-tab" onclick="switchQuestMode('decompose')" disabled>ë¶„í•´Â·í•©ì„±</button>
                         </div>

                         <!-- ê²Œì„ ì˜ì—­ -->
                         <div id="quest-game-area">
                             <!-- íƒ€ì¼ë§ ë© ëª¨ë“œ -->
                             <div id="tiling-mode" class="grid grid-cols-12 gap-4">
                                 <!-- ë³´ë“œ -->
                                 <div class="col-span-12 lg:col-span-8 bg-white rounded-3xl shadow-sm border border-gray-100">
                                     <div class="p-4">
                                         <div class="text-[12px] text-slate-600 mb-2">íƒ€ì¼ì„ ë°°ì¹˜í•´ íŒŒë€ ì˜ì—­ì„ ë¹ˆí‹ˆì—†ì´ ì±„ìš°ì„¸ìš”.</div>
                                         <div class="inline-block rounded-2xl p-2 bg-white shadow-inner">
                                             <div id="tiling-grid" class="grid gap-0" style="grid-template-columns: repeat(12, 24px); grid-template-rows: repeat(8, 24px);"></div>
                                         </div>
                                     </div>
                                 </div>

                                 <!-- ë„êµ¬ íŒ¨ë„ -->
                                 <div class="col-span-12 lg:col-span-4 bg-white rounded-3xl shadow-sm border border-gray-100">
                                     <div class="p-4 space-y-3">
                                         <div class="flex items-center justify-between">
                                             <div class="text-[13px] font-semibold">íƒ€ì¼ë§ ë©</div>
                                             <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800" id="tiling-progress">ë©´ì  0/24</span>
                                         </div>

                                         <div class="grid grid-cols-3 gap-2">
                                             <button class="bg-gradient-to-r from-indigo-500 to-mint-500 text-white px-3 py-2 rounded-xl text-[12px] font-medium tile-tool" data-type="1x1">1Ã—1</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium tile-tool" data-type="1x2">1Ã—2</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium tile-tool" data-type="2x2">2Ã—2</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium col-span-3" id="rotate-btn" onclick="rotateTile()" disabled>
                                                 <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path>
                                                 </svg>
                                                 íšŒì „
                                             </button>
                                         </div>

                                         <div class="flex gap-2">
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium" onclick="undoTile()">
                                                 <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path>
                                                 </svg>
                                                 ë˜ëŒë¦¬ê¸°
                                             </button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium" onclick="resetTiling()">
                                                 <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                                                 </svg>
                                                 ì´ˆê¸°í™”
                                             </button>
                                         </div>

                                         <div id="tiling-complete" class="hidden rounded-xl bg-emerald-50 text-emerald-800 p-3 text-[12px]">
                                             ì™„ë£Œ! ì •í™•íˆ ë®ì—ˆìŠµë‹ˆë‹¤. +50P
                                         </div>
                                     </div>
                                 </div>
                             </div>

                             <!-- ë¶„í•´Â·í•©ì„± ëª¨ë“œ -->
                             <div id="decompose-mode" class="hidden grid grid-cols-12 gap-4">
                                 <!-- ë³´ë“œ -->
                                 <div class="col-span-12 lg:col-span-8 bg-white rounded-3xl shadow-sm border border-gray-100">
                                     <div class="p-4">
                                         <div class="text-[12px] text-slate-600 mb-2">ì¡°ê°ì„ ë°°ì¹˜í•´ íšŒìƒ‰ ì˜ì—­ì„ ë¹ˆí‹ˆì—†ì´ ì±„ìš°ì„¸ìš”. (ì¡°ê° ë©´ì ì˜ í•© = ë„í˜•ì˜ ë„“ì´)</div>
                                         <div class="inline-block rounded-2xl p-2 bg-white shadow-inner">
                                             <div id="decompose-grid" class="grid gap-0" style="grid-template-columns: repeat(10, 24px); grid-template-rows: repeat(8, 24px);"></div>
                                         </div>
                                     </div>
                                 </div>

                                 <!-- ë„êµ¬ íŒ¨ë„ -->
                                 <div class="col-span-12 lg:col-span-4 bg-white rounded-3xl shadow-sm border border-gray-100">
                                     <div class="p-4 space-y-3">
                                         <div class="flex items-center justify-between">
                                             <div class="text-[13px] font-semibold">ë¶„í•´Â·í•©ì„±</div>
                                             <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800" id="decompose-progress">í•© 0 / ëª©í‘œ 24</span>
                                         </div>

                                         <div class="grid grid-cols-3 gap-2">
                                             <button class="bg-gradient-to-r from-emerald-500 to-teal-500 text-white px-3 py-2 rounded-xl text-[12px] font-medium piece-tool" data-key="A" data-w="2" data-h="2">2Ã—2</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium piece-tool" data-key="B" data-w="3" data-h="1">3Ã—1</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium piece-tool" data-key="C" data-w="1" data-h="3">1Ã—3</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium piece-tool" data-key="D" data-w="2" data-h="1">2Ã—1</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium piece-tool" data-key="E" data-w="1" data-h="2">1Ã—2</button>
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium col-span-3" onclick="rotatePiece()">
                                                 <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path>
                                                 </svg>
                                                 íšŒì „
                                             </button>
                                         </div>

                                         <div class="flex gap-2">
                                             <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium" onclick="undoPiece()">
                                                 <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                     <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path>
                                                     </svg>
                                                     ë˜ëŒë¦¬ê¸°
                                                 </button>
                                                 <button class="border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium" onclick="resetDecompose()">
                                                     <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                                                     </svg>
                                                     ì´ˆê¸°í™”
                                                 </button>
                                             </div>

                                             <div id="decompose-complete" class="hidden rounded-xl bg-indigo-50 text-indigo-800 p-3 text-[12px]">
                                                 ì™„ë£Œ! ì¡°ê° í•©ì´ ì •í™•í•©ë‹ˆë‹¤. +50P
                                             </div>
                                         </div>
                                     </div>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             `;
             
             document.body.appendChild(modal);
             
             // ê²Œì„ ì´ˆê¸°í™”
             initializeAreaQuest();
             startQuestTimer();
             
             // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
             document.addEventListener('keydown', function(e) {
                 if (e.key === 'Escape') {
                     closeAreaQuest();
                 }
             });
         }

         // ë„í˜•ì˜ ë„“ì´ í€´ì¦ˆ ë‹«ê¸°
         function closeAreaQuest() {
             const modal = document.getElementById('area-quest-modal');
             if (modal) {
                 modal.remove();
             }
             
             // ê²°ê³¼ íŒì—…ë„ í•¨ê»˜ ì œê±°
             const resultPopup = document.getElementById('quest-result-popup');
             if (resultPopup) {
                 resultPopup.remove();
             }
         }

         // ë„í˜•ì˜ ë„“ì´ í€´ì¦ˆ ì´ˆê¸°í™”
         function initializeAreaQuest() {
             renderTilingGrid();
             renderDecomposeGrid();
             updateQuestProgress();
             updateQuestTimer();
         }

         // íƒ€ì¼ë§ ê·¸ë¦¬ë“œ ë Œë”ë§
         function renderTilingGrid() {
             const grid = document.getElementById('tiling-grid');
             if (!grid) return;
             
             grid.innerHTML = '';
             
             for (let y = 0; y < 8; y++) {
                 for (let x = 0; x < 12; x++) {
                     const cell = document.createElement('button');
                     cell.className = 'w-6 h-6 border border-gray-300 cursor-pointer transition-all duration-200 hover:scale-110 hover:z-10';
                     cell.dataset.x = x;
                     cell.dataset.y = y;
                     
                     if (tilingTarget[y][x] === '#') {
                         cell.classList.add('bg-blue-100', 'border-blue-200');
                     } else {
                         cell.classList.add('bg-white', 'border-gray-200');
                     }
                     
                     cell.onclick = () => placeTile(x, y);
                     grid.appendChild(cell);
                 }
             }
         }

         // ë¶„í•´Â·í•©ì„± ê·¸ë¦¬ë“œ ë Œë”ë§
         function renderDecomposeGrid() {
             const grid = document.getElementById('decompose-grid');
             if (!grid) return;
             
             grid.innerHTML = '';
             
             for (let y = 0; y < 8; y++) {
                 for (let x = 0; x < 10; x++) {
                     const cell = document.createElement('button');
                     cell.className = 'w-6 h-6 border border-gray-300 cursor-pointer transition-all duration-200 hover:scale-110 hover:z-10';
                     cell.dataset.x = x;
                     cell.dataset.y = y;
                     
                     if (decomposeTarget[y][x] === '#') {
                         cell.classList.add('bg-gray-200', 'border-gray-300');
                     } else {
                         cell.classList.add('bg-white', 'border-gray-200');
                     }
                     
                     cell.onclick = () => placePiece(x, y);
                     grid.appendChild(cell);
                 }
             }
         }

         // ê²Œì„ ìƒíƒœ ë³€ìˆ˜ë“¤
         let questCurrentMode = 'tiling';
         let questTimeLeft = 45;
         let questCombo = 0;
         let questScore = 0;
         let questTilingCompleted = false;
         let questDecomposeCompleted = false;
         let questSelectedTileType = '1x1';
         let questTileDirection = 'H';
         let questPlacedTiles = [];
         let questNextTileId = 1;
         let questSelectedPiece = { key: 'A', w: 2, h: 2, label: '2Ã—2' };
         let questPlacedPieces = [];
         let questNextPieceId = 1;

         // ëª©í‘œ ëª¨ì–‘ë“¤
         const tilingTarget = [
             "....######..",
             "...#######..",
             "...#####....",
             "....####....",
             "....####....",
             ".....###....",
             "............",
             "............"
         ];

         const decomposeTarget = [
             "..######..",
             "..######..",
             "..#####...",
             "..#####...",
             "..####....",
             "..####....",
             "..........",
             ".........."
         ];

         // ëª¨ë“œ ì „í™˜
         function switchQuestMode(mode) {
             questCurrentMode = mode;
             
             // íƒ­ ìŠ¤íƒ€ì¼ ë³€ê²½
             document.getElementById('tiling-tab').className = mode === 'tiling' ? 'bg-gradient-to-r from-indigo-500 to-mint-500 text-white px-4 py-2 rounded-xl text-[12px] font-medium' : 'border border-gray-300 bg-white text-gray-700 px-4 py-2 rounded-xl text-[12px] font-medium';
             document.getElementById('decompose-tab').className = mode === 'decompose' ? 'bg-gradient-to-r from-indigo-500 to-mint-500 text-white px-4 py-2 rounded-xl text-[12px] font-medium' : 'border border-gray-300 bg-white text-gray-700 px-4 py-2 rounded-xl text-[12px] font-medium';
             
             // ì½˜í…ì¸  í‘œì‹œ/ìˆ¨ê¹€
             document.getElementById('tiling-mode').style.display = mode === 'tiling' ? 'grid' : 'none';
             document.getElementById('decompose-mode').style.display = mode === 'decompose' ? 'grid' : 'none';
         }

         // íƒ€ì¼ ë„êµ¬ ì„ íƒ
         document.addEventListener('click', function(e) {
             if (e.target.classList.contains('tile-tool')) {
                 document.querySelectorAll('.tile-tool').forEach(btn => {
                     btn.className = 'border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium tile-tool';
                 });
                 e.target.className = 'bg-gradient-to-r from-indigo-500 to-mint-500 text-white px-3 py-2 rounded-xl text-[12px] font-medium tile-tool';
                 questSelectedTileType = e.target.dataset.type;
                 
                 // 1x2 íƒ€ì¼ì¼ ë•Œë§Œ íšŒì „ ë²„íŠ¼ í™œì„±í™”
                 document.getElementById('rotate-btn').disabled = questSelectedTileType !== '1x2';
             }
             
             if (e.target.classList.contains('piece-tool')) {
                 document.querySelectorAll('.piece-tool').forEach(btn => {
                     btn.className = 'border border-gray-300 bg-white text-gray-700 px-3 py-2 rounded-xl text-[12px] font-medium piece-tool';
                 });
                 e.target.className = 'bg-gradient-to-r from-emerald-500 to-teal-500 text-white px-3 py-2 rounded-xl text-[12px] font-medium piece-tool';
                 questSelectedPiece = {
                     key: e.target.dataset.key,
                     w: parseInt(e.target.dataset.w),
                     h: parseInt(e.target.dataset.h),
                     label: e.target.textContent
                 };
             }
         });

         // íƒ€ì¼ ë°°ì¹˜
         function placeTile(x, y) {
             const cells = getTileCells(x, y, questSelectedTileType, questTileDirection);
             if (!canPlaceTile(cells)) return;
             
             const tile = {
                 id: questNextTileId++,
                 type: questSelectedTileType,
                 dir: questTileDirection,
                 cells: cells
             };
             
             questPlacedTiles.push(tile);
             updateTilingDisplay();
             checkTilingComplete();
             
             // ì½¤ë³´ ì¦ê°€
             questCombo++;
             updateQuestCombo();
         }

         // íƒ€ì¼ ì…€ ê³„ì‚°
         function getTileCells(x, y, type, dir) {
             if (type === '1x1') return [[x, y]];
             if (type === '2x2') return [[x, y], [x+1, y], [x, y+1], [x+1, y+1]];
             if (type === '1x2') {
                 return dir === 'H' ? [[x, y], [x+1, y]] : [[x, y], [x, y+1]];
             }
         }

         // íƒ€ì¼ ë°°ì¹˜ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
         function canPlaceTile(cells) {
             return cells.every(([x, y]) => {
                 return x >= 0 && y >= 0 && x < 12 && y < 8 && 
                        tilingTarget[y][x] === '#' && 
                        !isCellCovered(x, y);
             });
         }

         // ì…€ ì»¤ë²„ ì—¬ë¶€ í™•ì¸
         function isCellCovered(x, y) {
             return questPlacedTiles.some(tile => 
                 tile.cells.some(([tx, ty]) => tx === x && ty === y)
             );
         }

         // ë¶„í•´Â·í•©ì„± ì¡°ê° ë°°ì¹˜
         function placePiece(x, y) {
             if (!canPlacePiece(x, y, questSelectedPiece.w, questSelectedPiece.h)) return;
             
             const piece = {
                 id: questNextPieceId++,
                 x: x,
                 y: y,
                 w: questSelectedPiece.w,
                 h: questSelectedPiece.h,
                 key: questSelectedPiece.key
             };
             
             questPlacedPieces.push(piece);
             updateDecomposeDisplay();
             checkDecomposeComplete();
             
             // ì½¤ë³´ ì¦ê°€
             questCombo++;
             updateQuestCombo();
         }

         // ì¡°ê° ë°°ì¹˜ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
         function canPlacePiece(x, y, w, h) {
             if (x < 0 || y < 0 || x + w > 10 || y + h > 8) return false;
             
             for (let yy = 0; yy < h; yy++) {
                 for (let xx = 0; xx < w; xx++) {
                     if (decomposeTarget[y + yy][x + xx] !== '#') return false;
                     if (isPieceCellCovered(x + xx, y + yy)) return false;
                 }
             }
             return true;
         }

         // ì¡°ê° ì…€ ì»¤ë²„ ì—¬ë¶€ í™•ì¸
         function isPieceCellCovered(x, y) {
             return questPlacedPieces.some(piece => {
                 for (let yy = 0; yy < piece.h; yy++) {
                     for (let xx = 0; xx < piece.w; xx++) {
                         if (piece.x + xx === x && piece.y + yy === y) return true;
                     }
                 }
                 return false;
             });
         }

         // íƒ€ì¼ë§ ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
         function updateTilingDisplay() {
             // ëª¨ë“  ì…€ ì´ˆê¸°í™”
             document.querySelectorAll('#tiling-grid .w-6').forEach(cell => {
                 cell.className = 'w-6 h-6 border border-gray-300 cursor-pointer transition-all duration-200 hover:scale-110 hover:z-10';
                 const x = parseInt(cell.dataset.x);
                 const y = parseInt(cell.dataset.y);
                 
                 if (tilingTarget[y][x] === '#') {
                     cell.classList.add('bg-blue-100', 'border-blue-200');
                 } else {
                     cell.classList.add('bg-white', 'border-gray-200');
                 }
             });
             
             // ë°°ì¹˜ëœ íƒ€ì¼ í‘œì‹œ
             questPlacedTiles.forEach(tile => {
                 tile.cells.forEach(([x, y]) => {
                     const cell = document.querySelector(`#tiling-grid .w-6[data-x="${x}"][data-y="${y}"]`);
                     if (cell) {
                         cell.classList.remove('bg-blue-100', 'border-blue-200');
                         cell.classList.add('bg-indigo-500', 'border-indigo-500');
                     }
                 });
             });
             
             // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
             const coveredCount = questPlacedTiles.reduce((sum, tile) => sum + tile.cells.length, 0);
             const targetCount = tilingTarget.reduce((sum, row) => sum + row.split('').filter(c => c === '#').length, 0);
             document.getElementById('tiling-progress').textContent = `ë©´ì  ${coveredCount}/${targetCount}`;
         }

         // ë¶„í•´Â·í•©ì„± ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
         function updateDecomposeDisplay() {
             // ëª¨ë“  ì…€ ì´ˆê¸°í™”
             document.querySelectorAll('#decompose-grid .w-6').forEach(cell => {
                 cell.className = 'w-6 h-6 border border-gray-300 cursor-pointer transition-all duration-200 hover:scale-110 hover:z-10';
                 const x = parseInt(cell.dataset.x);
                 const y = parseInt(cell.dataset.y);
                 
                 if (decomposeTarget[y][x] === '#') {
                     cell.classList.add('bg-gray-200', 'border-gray-300');
                 } else {
                     cell.classList.add('bg-white', 'border-gray-200');
                 }
             });
             
             // ë°°ì¹˜ëœ ì¡°ê° í‘œì‹œ
             questPlacedPieces.forEach(piece => {
                 for (let yy = 0; yy < piece.h; yy++) {
                     for (let xx = 0; xx < piece.w; xx++) {
                         const cell = document.querySelector(`#decompose-grid .w-6[data-x="${piece.x + xx}"][data-y="${piece.y + yy}"]`);
                         if (cell) {
                             cell.classList.remove('bg-gray-200', 'border-gray-300');
                             cell.classList.add('bg-emerald-500', 'border-emerald-500');
                         }
                     }
                 }
             });
             
             // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
             const areaSum = questPlacedPieces.reduce((sum, piece) => sum + piece.w * piece.h, 0);
             const targetArea = decomposeTarget.reduce((sum, row) => sum + row.split('').filter(c => c === '#').length, 0);
             document.getElementById('decompose-progress').textContent = `í•© ${areaSum} / ëª©í‘œ ${targetArea}`;
         }

         // íƒ€ì¼ë§ ì™„ë£Œ í™•ì¸
         function checkTilingComplete() {
             const targetCount = tilingTarget.reduce((sum, row) => sum + row.split('').filter(c => c === '#').length, 0);
             const coveredCount = questPlacedTiles.reduce((sum, tile) => sum + tile.cells.length, 0);
             
             if (coveredCount === targetCount && questPlacedTiles.every(tile => 
                 tile.cells.every(([x, y]) => tilingTarget[y][x] === '#')
             )) {
                 questTilingCompleted = true;
                 document.getElementById('tiling-complete').classList.remove('hidden');
                 
                 // ë³´ìƒ ì§€ê¸‰
                 const reward = 50 + Math.floor(questCombo * 10);
                 questScore += reward;
                 showQuestReward(reward, 'íƒ€ì¼ë§ ì™„ë£Œ!');
                 
                 // ë‹¤ìŒ ëª¨ë“œ í•´ê¸ˆ
                 setTimeout(() => {
                     unlockDecomposeMode();
                 }, 2000);
             }
         }

         // ë¶„í•´Â·í•©ì„± ì™„ë£Œ í™•ì¸
         function checkDecomposeComplete() {
             const targetArea = decomposeTarget.reduce((sum, row) => sum + row.split('').filter(c => c === '#').length, 0);
             const areaSum = questPlacedPieces.reduce((sum, piece) => sum + piece.w * piece.h, 0);
             
             if (areaSum === targetArea && questPlacedPieces.every(piece => {
                 for (let yy = 0; yy < piece.h; yy++) {
                     for (let xx = 0; xx < piece.w; xx++) {
                         if (decomposeTarget[piece.y + yy][piece.x + xx] !== '#') return false;
                     }
                 }
                 return true;
             })) {
                 questDecomposeCompleted = true;
                 document.getElementById('decompose-complete').classList.remove('hidden');
                 
                 // ë³´ìƒ ì§€ê¸‰
                 const reward = 50 + Math.floor(questCombo * 10);
                 questScore += reward;
                 showQuestReward(reward, 'ë¶„í•´Â·í•©ì„± ì™„ë£Œ!');
                 
                 // ê²Œì„ ì™„ë£Œ
                 setTimeout(() => {
                     completeQuest();
                 }, 2000);
             }
         }

         // ë¶„í•´Â·í•©ì„± ëª¨ë“œ í•´ê¸ˆ
         function unlockDecomposeMode() {
             document.getElementById('decompose-tab').disabled = false;
             document.getElementById('decompose-tab').classList.remove('border', 'border-gray-300', 'bg-white', 'text-gray-700');
             document.getElementById('decompose-tab').classList.add('bg-gradient-to-r', 'from-emerald-500', 'to-teal-500', 'text-white');
             
             // ì•Œë¦¼ í‘œì‹œ
             showQuestNotification('ìƒˆë¡œìš´ ëª¨ë“œê°€ í•´ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
         }

         // ê²Œì„ ì™„ë£Œ
         function completeQuest() {
             const finalScore = questScore + Math.floor(questTimeLeft * 2);
             const finalCombo = questCombo;
             
             showQuestResult(finalScore, finalCombo);
         }

         // ë³´ìƒ í‘œì‹œ
         function showQuestReward(points, message) {
             const rewardDiv = document.createElement('div');
             rewardDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-xl p-6 shadow-2xl z-[1100] text-center';
             rewardDiv.innerHTML = `
                 <h3 class="text-lg font-bold text-emerald-800 mb-2">ğŸ‰ ${message}</h3>
                 <p class="text-2xl font-bold text-emerald-600 mb-2">+${points}P</p>
                 <p class="text-sm text-gray-600">ì½¤ë³´: ${questCombo}ë°°</p>
             `;
             
             document.body.appendChild(rewardDiv);
             
             setTimeout(() => {
                 rewardDiv.remove();
             }, 3000);
         }

         // ê²Œì„ ê²°ê³¼ í‘œì‹œ
         function showQuestResult(score, combo) {
             const resultDiv = document.createElement('div');
             resultDiv.id = 'quest-result-popup';
             resultDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-xl p-6 shadow-2xl z-[1100] text-center max-w-md';
             resultDiv.innerHTML = `
                 <h3 class="text-xl font-bold text-indigo-800 mb-4">ğŸ¯ ê²Œì„ ì™„ë£Œ!</h3>
                 <div class="space-y-3 text-center">
                     <div>
                         <p class="text-sm text-gray-600">ìµœì¢… ì ìˆ˜</p>
                         <p class="text-3xl font-bold text-indigo-600">${score}P</p>
                     </div>
                     <div>
                         <p class="text-sm text-gray-600">ìµœê³  ì½¤ë³´</p>
                         <p class="text-xl font-bold text-pink-600">${combo}ë°°</p>
                     </div>
                     <div class="pt-3">
                         <button class="bg-gradient-to-r from-indigo-500 to-mint-500 text-white px-6 py-2 rounded-xl font-medium" onclick="closeAreaQuest()">ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
                     </div>
                 </div>
             `;
             
             document.body.appendChild(resultDiv);
         }

         // ì•Œë¦¼ í‘œì‹œ
         function showQuestNotification(message, type = 'info') {
             const notification = document.createElement('div');
             notification.className = `fixed top-4 right-4 p-3 rounded-lg text-white text-sm z-[1100] ${
                 type === 'success' ? 'bg-emerald-500' : 'bg-blue-500'
             }`;
             notification.textContent = message;
             
             document.body.appendChild(notification);
             
             setTimeout(() => {
                 notification.remove();
             }, 3000);
         }

         // íƒ€ì¼ íšŒì „
         function rotateTile() {
             if (questSelectedTileType === '1x2') {
                 questTileDirection = questTileDirection === 'H' ? 'V' : 'H';
             }
         }

         // ì¡°ê° íšŒì „
         function rotatePiece() {
             const temp = questSelectedPiece.w;
             questSelectedPiece.w = questSelectedPiece.h;
             questSelectedPiece.h = temp;
             questSelectedPiece.label = `${questSelectedPiece.h}Ã—${questSelectedPiece.w}`;
             
             // ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
             document.querySelectorAll('.piece-tool').forEach(btn => {
                 if (btn.dataset.key === questSelectedPiece.key) {
                     btn.textContent = questSelectedPiece.label;
                 }
             });
         }

         // íƒ€ì¼ ë˜ëŒë¦¬ê¸°
         function undoTile() {
             if (questPlacedTiles.length > 0) {
                 questPlacedTiles.pop();
                 updateTilingDisplay();
                 questCombo = Math.max(0, questCombo - 1);
                 updateQuestCombo();
             }
         }

         // ì¡°ê° ë˜ëŒë¦¬ê¸°
         function undoPiece() {
             if (questPlacedPieces.length > 0) {
                 questPlacedPieces.pop();
                 updateDecomposeDisplay();
                 questCombo = Math.max(0, questCombo - 1);
                 updateQuestCombo();
             }
         }

         // íƒ€ì¼ë§ ì´ˆê¸°í™”
         function resetTiling() {
             questPlacedTiles = [];
             updateTilingDisplay();
             questCombo = 0;
             updateQuestCombo();
             document.getElementById('tiling-complete').classList.add('hidden');
         }

         // ë¶„í•´Â·í•©ì„± ì´ˆê¸°í™”
         function resetDecompose() {
             questPlacedPieces = [];
             updateDecomposeDisplay();
             questCombo = 0;
             updateQuestCombo();
             document.getElementById('decompose-complete').classList.add('hidden');
         }

         // ì½¤ë³´ ì—…ë°ì´íŠ¸
         function updateQuestCombo() {
             // ì½¤ë³´ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ëŠ” ì—¬ê¸°ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
         }

         // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
         function updateQuestProgress() {
             let progress = 10;
             if (questTilingCompleted) progress += 30;
             if (questDecomposeCompleted) progress += 60;
             
             const progressBar = document.getElementById('quest-progress');
             if (progressBar) {
                 progressBar.style.width = progress + '%';
             }
         }

         // í€˜ìŠ¤íŠ¸ íƒ€ì´ë¨¸ ì‹œì‘
         function startQuestTimer() {
             const timerInterval = setInterval(() => {
                 questTimeLeft--;
                 updateQuestTimer();
                 
                 if (questTimeLeft <= 0) {
                     clearInterval(timerInterval);
                     questTimeUp();
                 }
             }, 1000);
         }

         // í€˜ìŠ¤íŠ¸ íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
         function updateQuestTimer() {
             const minutes = Math.floor(questTimeLeft / 60);
             const seconds = questTimeLeft % 60;
             const timerElement = document.getElementById('quest-timer');
             if (timerElement) {
                 timerElement.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
             }
         }

         // í€˜ìŠ¤íŠ¸ ì‹œê°„ ì¢…ë£Œ
         function questTimeUp() {
             showQuestNotification('ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'info');
             setTimeout(() => {
                 completeQuest();
             }, 2000);
         }

                 // ê°œìˆ˜ ì„¸ê¸° ê²Œì„ ì‹œì‘
        function startCountingGame() {
            const popup = document.getElementById('counting-game-popup');
            const iframe = document.getElementById('counting-game-iframe');
            
            popup.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
            
            // iframe ì†ŒìŠ¤ë¥¼ ì„¤ì •í•˜ê³  ë¡œë“œ ì™„ë£Œ ëŒ€ê¸°
            iframe.src = 'counting-game.html';
            
            // iframe ë¡œë“œ ì™„ë£Œ í›„ í¬ì»¤ìŠ¤ ì„¤ì •
            iframe.onload = function() {
                iframe.style.opacity = '1';
            };
            
            // ì´ˆê¸° íˆ¬ëª…ë„ ì„¤ì •
            iframe.style.opacity = '0';
            iframe.style.transition = 'opacity 0.3s ease-in-out';
        }

        // ì•„ë°”íƒ€ ìƒì  ê´€ë ¨ í•¨ìˆ˜ë“¤
        const AVATAR_DATA = [
            {
                id: 'basic',
                name: 'ê¸°ë³¸ ì•„ë°”íƒ€',
                category: 'free',
                price: 0,
                owned: true,
                selected: true,
                colors: ['from-blue-400', 'to-purple-500']
            },
            {
                id: 'student',
                name: 'í•™ìƒ ì•„ë°”íƒ€',
                category: 'free',
                price: 0,
                owned: true,
                selected: false,
                colors: ['from-green-400', 'to-teal-500']
            },
            {
                id: 'wizard',
                name: 'ë§ˆë²•ì‚¬ ì•„ë°”íƒ€',
                category: 'premium',
                price: 500,
                owned: true,
                selected: false,
                colors: ['from-purple-400', 'to-pink-500']
            },
            {
                id: 'knight',
                name: 'ê¸°ì‚¬ ì•„ë°”íƒ€',
                category: 'premium',
                price: 800,
                owned: true,
                selected: false,
                colors: ['from-gray-600', 'to-gray-800']
            },
            {
                id: 'ninja',
                name: 'ë‹Œì ì•„ë°”íƒ€',
                category: 'premium',
                price: 1000,
                owned: false,
                selected: false,
                colors: ['from-black', 'to-gray-700']
            },
            {
                id: 'robot',
                name: 'ë¡œë´‡ ì•„ë°”íƒ€',
                category: 'seasonal',
                price: 1500,
                owned: false,
                selected: false,
                colors: ['from-blue-500', 'to-cyan-400']
            },
            {
                id: 'dragon',
                name: 'ë“œë˜ê³¤ ì•„ë°”íƒ€',
                category: 'seasonal',
                price: 2000,
                owned: false,
                selected: false,
                colors: ['from-red-500', 'to-orange-500']
            },
            {
                id: 'unicorn',
                name: 'ìœ ë‹ˆì½˜ ì•„ë°”íƒ€',
                category: 'seasonal',
                price: 2500,
                owned: false,
                selected: false,
                colors: ['from-pink-400', 'to-purple-400']
            }
        ];

        let currentAvatar = 'basic';

        // ì•„ë°”íƒ€ ìƒì  ì—´ê¸°
        function openAvatarShop() {
            document.getElementById('avatar-shop-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
            renderAvatarGrid('all');
            setupAvatarShopEventListeners();
            updateAvatarShopPoints();
        }

        // ì•„ë°”íƒ€ ìƒì  ë‹«ê¸°
        function closeAvatarShop() {
            document.getElementById('avatar-shop-modal').classList.add('hidden');
            document.body.style.overflow = 'auto'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
        }

        // ê²½ë§¤ íŠœí† ë¦¬ì–¼ ì—´ê¸°
        function openAuctionTutorial() {
            document.getElementById('auction-tutorial-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
            initTutorial();
        }

        // ê²½ë§¤ íŠœí† ë¦¬ì–¼ ë‹«ê¸°
        function closeAuctionTutorial() {
            console.log('ê²½ë§¤ íŠœí† ë¦¬ì–¼ ì°½ ë‹«ê¸°');
            document.getElementById('auction-tutorial-modal').classList.add('hidden');
            document.body.style.overflow = 'auto'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
            // ìŠ¬ë¼ì´ë“œ ìƒíƒœ ì´ˆê¸°í™”
            currentSlide = 0;
            // ëª¨ë“  ìŠ¬ë¼ì´ë“œë¥¼ ìˆ¨ê¸°ê³  ì²« ë²ˆì§¸ë§Œ ë³´ì´ê²Œ
            const slides = document.querySelectorAll('.slide');
            slides.forEach((slide, index) => {
                if (index === 0) {
                    slide.classList.remove('hidden');
                    slide.classList.add('active');
                } else {
                    slide.classList.add('hidden');
                    slide.classList.remove('active');
                }
            });
            // ì¸ë””ì¼€ì´í„° ì´ˆê¸°í™”
            updatePageIndicators(0);
        }

        // íŠœí† ë¦¬ì–¼ ì´ˆê¸°í™”
        function initTutorial() {
            currentSlide = 0;
            console.log('íŠœí† ë¦¬ì–¼ ì´ˆê¸°í™”, í˜„ì¬ ìŠ¬ë¼ì´ë“œ:', currentSlide);
            showSlide(0);
            updateNavigation();
            updatePageIndicators(0);
        }

        // ìŠ¬ë¼ì´ë“œ í‘œì‹œ
        function showSlide(slideIndex) {
            const slides = document.querySelectorAll('.slide');
            slides.forEach((slide, index) => {
                if (index === slideIndex) {
                    slide.classList.remove('hidden');
                    slide.classList.add('active');
                } else {
                    slide.classList.add('hidden');
                    slide.classList.remove('active');
                }
            });
        }

        // ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ
        function nextSlide() {
            if (currentSlide < 8) { // ì´ 9ê°œ ìŠ¬ë¼ì´ë“œ (0-8)
                currentSlide++;
                console.log('ë‹¤ìŒ ìŠ¬ë¼ì´ë“œë¡œ ì´ë™:', currentSlide);
                showSlide(currentSlide);
                updateNavigation();
                updatePageIndicators(currentSlide);
            } else if (currentSlide === 8) {
                // ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œì—ì„œ ì™„ë£Œ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì°½ ë‹«ê¸°
                console.log('íŠœí† ë¦¬ì–¼ ì™„ë£Œ, ì°½ ë‹«ê¸°');
                closeAuctionTutorial();
            }
        }

        // ì´ì „ ìŠ¬ë¼ì´ë“œ
        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
                updateNavigation();
                updatePageIndicators(currentSlide);
            }
        }

        // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì—…ë°ì´íŠ¸
        function updateNavigation() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentSlide === 0;
            nextBtn.disabled = currentSlide === 8;
            
            if (currentSlide === 8) {
                nextBtn.textContent = 'ì™„ë£Œ';
                nextBtn.onclick = () => {
                    console.log('ì™„ë£Œ ë²„íŠ¼ í´ë¦­, ì°½ ë‹«ê¸°');
                    closeAuctionTutorial();
                };
            } else {
                nextBtn.textContent = 'ë‹¤ìŒ';
                nextBtn.onclick = nextSlide;
            }
        }

        // í˜ì´ì§€ ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸
        function updatePageIndicators(activeIndex) {
            const indicators = document.querySelectorAll('#page-indicators div');
            console.log('ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸:', activeIndex, 'ê°œìˆ˜:', indicators.length);
            indicators.forEach((indicator, index) => {
                if (index === activeIndex) {
                    indicator.classList.add('active');
                    indicator.style.background = '#3b82f6';
                    indicator.style.transform = 'scale(1.2)';
                    console.log('í™œì„±í™”ëœ ì¸ë””ì¼€ì´í„°:', index);
                } else {
                    indicator.classList.remove('active');
                    indicator.style.background = '#d1d5db';
                    indicator.style.transform = 'scale(1)';
                }
            });
        }

        // í€´ì¦ˆ ê²°ê³¼ ì´ˆê¸°í™”
        function resetQuizResults() {
            const results = document.querySelectorAll('[id^="quiz-result-"]');
            results.forEach(result => result.classList.add('hidden'));
            
            const choices = document.querySelectorAll('.quiz-choice');
            choices.forEach(choice => {
                choice.classList.remove('correct', 'incorrect');
            });
        }

        // í€´ì¦ˆ ì„ íƒ ì²˜ë¦¬
        function handleQuizChoice(quizNumber, choiceIndex, correctIndex) {
            const choices = document.querySelectorAll(`#quiz-choices-${quizNumber} .quiz-choice`);
            const result = document.getElementById(`quiz-result-${quizNumber}`);
            
            // ëª¨ë“  ì„ íƒì§€ ë¹„í™œì„±í™”
            choices.forEach(choice => {
                choice.style.pointerEvents = 'none';
            });
            
            // ì •ë‹µ/ì˜¤ë‹µ í‘œì‹œ
            choices.forEach((choice, index) => {
                if (index === correctIndex) {
                    choice.classList.add('correct');
                } else if (index === choiceIndex && index !== correctIndex) {
                    choice.classList.add('incorrect');
                }
            });
            
            // ê²°ê³¼ í‘œì‹œ
            result.classList.remove('hidden');
            
            // 2ì´ˆ í›„ ë‹¤ìŒ ìŠ¬ë¼ì´ë“œë¡œ ìë™ ì´ë™
            setTimeout(() => {
                nextSlide();
            }, 2000);
        }

        // ì „ì—­ ë³€ìˆ˜
        let currentSlide = 0;

        // ì•„ë°”íƒ€ ê·¸ë¦¬ë“œ ë Œë”ë§
        function renderAvatarGrid(category) {
            const grid = document.getElementById('avatar-grid');
            const filteredAvatars = category === 'all' ? AVATAR_DATA : AVATAR_DATA.filter(avatar => avatar.category === category);
            
            grid.innerHTML = filteredAvatars.map(avatar => `
                <div class="avatar-item ${avatar.owned ? 'owned' : ''} ${avatar.selected ? 'selected' : ''} ${!avatar.owned ? 'locked' : ''}" 
                     data-avatar-id="${avatar.id}" onclick="selectAvatar('${avatar.id}')">
                                    <div class="w-20 h-20 bg-gradient-to-br ${avatar.colors.join(' ')} rounded-full flex items-center justify-center shadow-lg border-2 border-white mx-auto mb-3 overflow-hidden">
                        ${avatar.id === 'basic' ? `
                            <img src="assets/tennis_pet_transparent.svg" class="w-14 h-14" alt="í…Œë‹ˆìŠ¤ í« ì•„ë°”íƒ€">
                        ` : avatar.id === 'student' ? `
                            <img src="assets/avatar_student.svg" class="w-14 h-14" alt="í•™ìƒ ì•„ë°”íƒ€">
                        ` : avatar.id === 'wizard' ? `
                            <img src="assets/avatar_wizard.svg" class="w-14 h-14" alt="ë§ˆë²•ì‚¬ ì•„ë°”íƒ€">
                        ` : avatar.id === 'knight' ? `
                            <img src="assets/avatar_knight.svg" class="w-14 h-14" alt="ê¸°ì‚¬ ì•„ë°”íƒ€">
                        ` : avatar.id === 'ninja' ? `
                            <img src="assets/avatar_ninja.svg" class="w-14 h-14" alt="ë‹Œì ì•„ë°”íƒ€">
                        ` : avatar.id === 'robot' ? `
                            <img src="assets/avatar_robot.svg" class="w-14 h-14" alt="ë¡œë´‡ ì•„ë°”íƒ€">
                        ` : avatar.id === 'dragon' ? `
                            <img src="assets/avatar_dragon.svg" class="w-14 h-14" alt="ë“œë˜ê³¤ ì•„ë°”íƒ€">
                        ` : avatar.id === 'unicorn' ? `
                            <img src="assets/avatar_unicorn.svg" class="w-14 h-14" alt="ìœ ë‹ˆì½˜ ì•„ë°”íƒ€">
                        ` : `
                            <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <!-- ê¸°ë³¸ ì‚¬ëŒ ì•„ì´ì½˜ (ê¸°íƒ€ ì•„ë°”íƒ€ìš©) -->
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                        `}
                    </div>
                    <h4 class="font-medium text-slate-800 text-xs mb-1">${avatar.name}</h4>
                    <div class="flex items-center justify-center gap-1">
                        ${avatar.owned ? 
                            '<span class="text-xs text-green-600 font-medium">ë³´ìœ  ì¤‘</span>' : 
                            `<span class="text-xs text-slate-600">${avatar.price}P</span>`
                        }
                    </div>
                    ${avatar.selected ? '<div class="mt-1 text-xs text-blue-600 font-medium">ì°©ìš© ì¤‘</div>' : ''}
                </div>
            `).join('');
        }

        // ì•„ë°”íƒ€ ì„ íƒ
        function selectAvatar(avatarId) {
            const avatar = AVATAR_DATA.find(a => a.id === avatarId);
            if (!avatar.owned) {
                // êµ¬ë§¤ í™•ì¸ ëª¨ë‹¬ í‘œì‹œ
                showAvatarPurchaseModal(avatar);
                return;
            }

            // ê¸°ì¡´ ì„ íƒ í•´ì œ
            AVATAR_DATA.forEach(a => a.selected = false);
            // ìƒˆ ì•„ë°”íƒ€ ì„ íƒ
            avatar.selected = true;
            currentAvatar = avatarId;
            
            // ì•„ë°”íƒ€ ìƒì  ì—…ë°ì´íŠ¸
            renderAvatarGrid(document.querySelector('.avatar-category-btn.active').dataset.category);
            updateCurrentAvatarDisplay();
            
            // ë©”ì¸ í™”ë©´ ì•„ë°”íƒ€ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
            updateMainAvatar();
            
            // ì•„ë°”íƒ€ ìƒì  ë‹«ê¸° (ì„ íƒì‚¬í•­)
            // closeAvatarShop();
        }

        // ì•„ë°”íƒ€ êµ¬ë§¤ ëª¨ë‹¬ í‘œì‹œ
        function showAvatarPurchaseModal(avatar) {
            const modal = document.getElementById('avatar-purchase-modal');
            const avatarImage = document.getElementById('purchase-avatar-image');
            const avatarName = document.getElementById('purchase-avatar-name');
            const avatarPrice = document.getElementById('purchase-avatar-price');
            
            // ì•„ë°”íƒ€ ì´ë¯¸ì§€ ì„¤ì •
            if (avatar.id === 'basic') {
                avatarImage.innerHTML = `<img src="assets/tennis_pet_transparent.svg" class="w-12 h-12" alt="í…Œë‹ˆìŠ¤ í« ì•„ë°”íƒ€">`;
            } else if (avatar.id === 'student') {
                avatarImage.innerHTML = `<img src="assets/avatar_student.svg" class="w-12 h-12" alt="í•™ìƒ ì•„ë°”íƒ€">`;
            } else if (avatar.id === 'wizard') {
                avatarImage.innerHTML = `<img src="assets/avatar_wizard.svg" class="w-12 h-12" alt="ë§ˆë²•ì‚¬ ì•„ë°”íƒ€">`;
            } else if (avatar.id === 'knight') {
                avatarImage.innerHTML = `<img src="assets/avatar_knight.svg" class="w-12 h-12" alt="ê¸°ì‚¬ ì•„ë°”íƒ€">`;
            } else if (avatar.id === 'ninja') {
                avatarImage.innerHTML = `<img src="assets/avatar_ninja.svg" class="w-12 h-12" alt="ë‹Œì ì•„ë°”íƒ€">`;
            } else if (avatar.id === 'robot') {
                avatarImage.innerHTML = `<img src="assets/avatar_robot.svg" class="w-12 h-12" alt="ë¡œë´‡ ì•„ë°”íƒ€">`;
            } else if (avatar.id === 'dragon') {
                avatarImage.innerHTML = `<img src="assets/avatar_dragon.svg" class="w-12 h-12" alt="ë“œë˜ê³¤ ì•„ë°”íƒ€">`;
            } else if (avatar.id === 'unicorn') {
                avatarImage.innerHTML = `<img src="assets/avatar_unicorn.svg" class="w-12 h-12" alt="ìœ ë‹ˆì½˜ ì•„ë°”íƒ€">`;
            }
            
            // ì•„ë°”íƒ€ ì´ë¦„ê³¼ ê°€ê²© ì„¤ì •
            avatarName.textContent = avatar.name;
            avatarPrice.textContent = `${avatar.price}P`;
            
            // ëª¨ë‹¬ í‘œì‹œ
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            
            // í˜„ì¬ ì„ íƒëœ ì•„ë°”íƒ€ ID ì €ì¥
            window.currentPurchaseAvatarId = avatar.id;
        }

        // ì•„ë°”íƒ€ êµ¬ë§¤ ëª¨ë‹¬ ë‹«ê¸°
        function closeAvatarPurchaseModal() {
            const modal = document.getElementById('avatar-purchase-modal');
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto';
            window.currentPurchaseAvatarId = null;
        }

        // ì•„ë°”íƒ€ êµ¬ë§¤ í™•ì¸
        function confirmAvatarPurchase() {
            const avatarId = window.currentPurchaseAvatarId;
            if (avatarId) {
                const avatar = AVATAR_DATA.find(a => a.id === avatarId);
                if (avatar) {
                    // êµ¬ë§¤ ë¡œì§ ì‹¤í–‰
                    avatar.owned = true;
                    renderAvatarGrid(document.querySelector('.avatar-category-btn.active').dataset.category);
                    updateCurrentAvatarDisplay();
                    
                    // ëª¨ë‹¬ ë‹«ê¸°
                    closeAvatarPurchaseModal();
                    
                    // êµ¬ë§¤ ì™„ë£Œ ì•Œë¦¼ (ì„ íƒì‚¬í•­)
                    setTimeout(() => {
                        alert(`ğŸ‰ ${avatar.name} êµ¬ë§¤ ì™„ë£Œ! ì´ì œ ì°©ìš©í•  ìˆ˜ ìˆì–´ìš”!`);
                    }, 100);
                }
            }
        }

        // í˜„ì¬ ì•„ë°”íƒ€ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateCurrentAvatarDisplay() {
            const currentAvatarData = AVATAR_DATA.find(a => a.id === currentAvatar);
            const currentAvatarElement = document.querySelector('#avatar-shop-modal .border-t .w-20');
            const currentAvatarName = document.querySelector('#avatar-shop-modal .border-t .font-medium');
            
            if (currentAvatarData && currentAvatarElement && currentAvatarName) {
                currentAvatarElement.className = `w-20 h-20 bg-gradient-to-br ${currentAvatarData.colors.join(' ')} rounded-full flex items-center justify-center shadow-lg border-4 border-white`;
                currentAvatarName.textContent = currentAvatarData.name;
            }
        }

        // ë©”ì¸ í™”ë©´ ì•„ë°”íƒ€ ì—…ë°ì´íŠ¸
        function updateMainAvatar() {
            const currentAvatarData = AVATAR_DATA.find(a => a.id === currentAvatar);
            const mainAvatar = document.querySelector('.card-shadow .w-48');
            
            if (currentAvatarData && mainAvatar) {
                // ì•„ë°”íƒ€ ì´ë¯¸ì§€ì™€ ë°°ê²½ìƒ‰ ëª¨ë‘ ì—…ë°ì´íŠ¸
                mainAvatar.className = `w-48 h-48 bg-gradient-to-br ${currentAvatarData.colors.join(' ')} rounded-full flex items-center justify-center shadow-lg border-4 border-white`;
                
                // ì•„ë°”íƒ€ ì´ë¯¸ì§€ë„ ì—…ë°ì´íŠ¸
                const avatarImg = mainAvatar.querySelector('img');
                if (avatarImg) {
                    if (currentAvatarData.id === 'basic') {
                        avatarImg.src = 'assets/tennis_pet_transparent.svg';
                    } else if (currentAvatarData.id === 'student') {
                        avatarImg.src = 'assets/avatar_student.svg';
                    } else if (currentAvatarData.id === 'wizard') {
                        avatarImg.src = 'assets/avatar_wizard.svg';
                    } else if (currentAvatarData.id === 'knight') {
                        avatarImg.src = 'assets/avatar_knight.svg';
                    } else if (currentAvatarData.id === 'ninja') {
                        avatarImg.src = 'assets/avatar_ninja.svg';
                    } else if (currentAvatarData.id === 'robot') {
                        avatarImg.src = 'assets/avatar_robot.svg';
                    } else if (currentAvatarData.id === 'dragon') {
                        avatarImg.src = 'assets/avatar_dragon.svg';
                    } else if (currentAvatarData.id === 'unicorn') {
                        avatarImg.src = 'assets/avatar_unicorn.svg';
                    }
                }
            }
        }

        // ì•„ë°”íƒ€ ìƒì  í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
        function updateAvatarShopPoints() {
            const pointsElement = document.getElementById('avatar-shop-points');
            if (pointsElement) {
                // ë©”ì¸ í™”ë©´ì˜ í¬ì¸íŠ¸ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ í‘œì‹œ
                const mainPointsElement = document.querySelector('.text-lg.font-extrabold.text-yellow-500');
                if (mainPointsElement) {
                    pointsElement.textContent = mainPointsElement.textContent;
                } else {
                    // ê¸°ë³¸ê°’ ì„¤ì •
                    pointsElement.textContent = '1,240P';
                }
            }
        }

        // ì•„ë°”íƒ€ ìƒì  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupAvatarShopEventListeners() {
            const categoryButtons = document.querySelectorAll('.avatar-category-btn');
            categoryButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // ê¸°ì¡´ í™œì„± ë²„íŠ¼ ë¹„í™œì„±í™”
                    categoryButtons.forEach(btn => btn.classList.remove('active'));
                    // í˜„ì¬ ë²„íŠ¼ í™œì„±í™”
                    this.classList.add('active');
                    // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ ì•„ë°”íƒ€ í‘œì‹œ
                    renderAvatarGrid(this.dataset.category);
                });
            });
        }

        // í’ì„  ë§ì…ˆ ê²Œì„ ì‹œì‘ (ê°œìˆ˜ ì„¸ê¸° ê²Œì„ê³¼ ë™ì¼í•œ ë°©ì‹)
        function openBalloonAdditionGame() {
            const popup = document.getElementById('balloon-addition-game-popup');
            const iframe = document.getElementById('balloon-addition-game-iframe');
            
            popup.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
            
            // iframe ì†ŒìŠ¤ë¥¼ ì„¤ì •í•˜ê³  ë¡œë“œ ì™„ë£Œ ëŒ€ê¸°
            iframe.src = 'balloon_addition_game.html';
            
            // iframe ë¡œë“œ ì™„ë£Œ í›„ í¬ì»¤ìŠ¤ ì„¤ì •
            iframe.onload = function() {
                iframe.style.opacity = '1';
            };
            
            // ì´ˆê¸° íˆ¬ëª…ë„ ì„¤ì •
            iframe.style.opacity = '0';
            iframe.style.transition = 'opacity 0.3s ease-in-out';
        }

        // Pet Studio ëª¨ë‹¬ íŒì—… ì—´ê¸°
        function openPetStudio() {
            const popup = document.getElementById('pet-studio-popup');
            const iframe = document.getElementById('pet-studio-iframe');
            
            popup.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
            
            // iframe ì†ŒìŠ¤ë¥¼ ì„¤ì •í•˜ê³  ë¡œë“œ ì™„ë£Œ ëŒ€ê¸°
            iframe.src = 'petstudio.html';
            
            // iframe ë¡œë“œ ì™„ë£Œ í›„ í¬ì»¤ìŠ¤ ì„¤ì •
            iframe.onload = function() {
                iframe.style.opacity = '1';
            };
            
            // ì´ˆê¸° íˆ¬ëª…ë„ ì„¤ì •
            iframe.style.opacity = '0';
            iframe.style.transition = 'opacity 0.3s ease-in-out';
        }

        // Pet Studio ëª¨ë‹¬ íŒì—… ë‹«ê¸°
        function closePetStudio() {
            document.getElementById('pet-studio-popup').classList.add('hidden');
            document.body.style.overflow = 'auto'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
        }

        // ê°œìˆ˜ ì„¸ê¸° ê²Œì„ ëª¨ë‹¬ íŒì—… ë‹«ê¸°
        function closeCountingGame() {
            document.getElementById('counting-game-popup').classList.add('hidden');
            document.body.style.overflow = 'auto'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
        }

        // í’ì„  ë§ì…ˆ ê²Œì„ ëª¨ë‹¬ íŒì—… ë‹«ê¸°
        function closeBalloonAdditionGame() {
            document.getElementById('balloon-addition-game-popup').classList.add('hidden');
            document.body.style.overflow = 'auto'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
        }

        // ì§„í–‰ ì¤‘ ê³¼ì œ ì¹´ë“œ ê³ ë„í™” ê¸°ëŠ¥
        const ALL_TASKS = [
            {id:'t1', scope:'today', title:'ëƒì…ˆ ì—°ìŠµ', subject:'ì—°ì‚°', progress:1.0, estimateMin:5, rewardPoint:40},
            {id:'t2', scope:'today', title:'ê°œìˆ˜ ì„¸ê¸° í€´ì¦ˆ', subject:'ì—°ì‚°', progress:0.2, estimateMin:3, rewardPoint:30},
            {id:'t3', scope:'today', title:'ë„í˜• ë„“ì´ 1ë‹¨ê³„', subject:'ë„í˜•', progress:0.35, estimateMin:4, rewardPoint:25},
            {id:'t4', scope:'week', title:'ê·œì¹™ ì°¾ê¸° ì±Œë¦°ì§€', subject:'ê·œì¹™', progress:0.55, estimateMin:6, rewardPoint:45},
            {id:'t5', scope:'week', title:'ë¶„ìˆ˜ì˜ ë§ì…ˆ â‘ ', subject:'ë¶„ìˆ˜', progress:0.8, estimateMin:5, rewardPoint:50},
            {id:'t6', scope:'all', title:'ì‹œê°/ì‹œê°„ í¼ì¦', subject:'ì‹œê°', progress:0.15, estimateMin:5, rewardPoint:25},
        ];

        const ICONS = {
            'ë¶„ìˆ˜': fracIcon(),
            'ë„í˜•': triIcon(),
            'ì—°ì‚°': plusIcon(),
            'ê·œì¹™': patternIcon(),
            'ì‹œê°': clockIcon()
        };

        // í•„í„° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            const filters = {
                today: document.getElementById('f-today'),
                week: document.getElementById('f-week'),
                all: document.getElementById('f-all')
            };
            
            let scope = 'today';
            
            Object.entries(filters).forEach(([k, el]) => {
                el.addEventListener('click', () => {
                    scope = k;
                    setActiveFilter();
                    renderProgress();
                });
            });

            function setActiveFilter() {
                Object.entries(filters).forEach(([k, el]) => {
                    const active = k === scope;
                    el.classList.toggle('bg-white', active);
                    el.classList.toggle('text-blue-700', active);
                    el.classList.toggle('shadow', active);
                    el.classList.toggle('text-white/90', !active);
                    el.classList.toggle('hover:bg-white/10', !active);
                    el.setAttribute('aria-pressed', active ? 'true' : 'false');
                });
            }

            function renderProgress() {
                const data = ALL_TASKS.filter(t => 
                    scope === 'all' ? true : 
                    (t.scope === 'today' || (scope === 'week' && (t.scope === 'today' || t.scope === 'week')))
                );
                
                let sumProgress = 0;
                data.forEach(t => {
                    sumProgress += t.progress;
                });

                // ë©”ì¸ ì§„í–‰ë¥  ë°” ì—…ë°ì´íŠ¸
                const mainProgressBar = document.getElementById('main-progress-bar');
                if (mainProgressBar) {
                    const avgProgress = data.length ? sumProgress / data.length : 0;
                    const progressPercent = Math.round(avgProgress * 100);
                    mainProgressBar.style.width = progressPercent + '%';
                }

                const avg = data.length ? sumProgress / data.length : 0;
                document.getElementById('totalPct').textContent = `(${data.length}ê°œ ì¤‘ ì§„í–‰ë¥  ${Math.round(avg * 100)}%)`;

                // Up next (ë¯¸ì™„ë£Œ ì¤‘ ê°€ì¥ ì§„í–‰ë¥  ë‚®ì€ ê²ƒ)
                const up = [...data].filter(t => t.progress < 1).sort((a, b) => a.progress - b.progress)[0];
                if (up) {
                    document.getElementById('nextTitle').textContent = up.title;
                    document.getElementById('nextBar').style.width = Math.round(up.progress * 100) + '%';
                    document.getElementById('nextEta').querySelector('b').textContent = up.estimateMin;
                    
                    // ë³´ìƒ í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
                    const rewardElement = document.querySelector('.bg-gradient-to-r.from-yellow-400.to-orange-400');
                    if (rewardElement) {
                        rewardElement.innerHTML = `ë³´ìƒ <b>${up.rewardPoint}P</b>`;
                    }
                }

                // ì´ì–´í•˜ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²° (ëƒì…ˆ ì—°ìŠµ ìš°ì„ )
                document.getElementById('btnContinue').onclick = () => {
                    // ëƒì…ˆ ì—°ìŠµì´ ìˆìœ¼ë©´ ìš°ì„  ì‹¤í–‰
                    const additionTask = data.find(t => t.title === 'ëƒì…ˆ ì—°ìŠµ');
                    if (additionTask) {
                        openBalloonAdditionGame();
                    } else if (up && up.title === 'ê°œìˆ˜ ì„¸ê¸° í€´ì¦ˆ') {
                        startCountingGame();
                    } else if (up) {
                        alert(`"${up.title}" ì´ì–´í•˜ê¸° íŒì—… ì—´ê¸°`);
                    } else {
                        // ëª¨ë“  ê³¼ì œê°€ ì™„ë£Œëœ ê²½ìš° ëƒì…ˆ ì—°ìŠµ ì‹¤í–‰
                        openBalloonAdditionGame();
                    }
                };

                // ì „ì²´ ë³´ê¸° ë²„íŠ¼
                document.getElementById('btnAll').onclick = () => alert('ê³¼ì œ ì „ì²´ ë³´ê¸°ë¡œ ì´ë™');
            }

            // ì´ˆê¸° ë Œë”ë§
            setActiveFilter();
            renderProgress();
        });

        // SVG ì•„ì´ì½˜ í•¨ìˆ˜ë“¤
        function triIcon() {
            return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M12 4l7 14H5L12 4z" fill="#4f46e5" stroke="#312e81" stroke-width="1.5"/></svg>`;
        }
        function fracIcon() {
            return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M5 8h8M5 16h8M14 6l4 12" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"/></svg>`;
        }
        function plusIcon() {
            return `<svg width="18" height="18" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14" stroke="#22c55e" stroke-width="2" stroke-linecap="round"/></svg>`;
        }
        function patternIcon() {
            return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <rect x="4" y="4" width="6" height="6" rx="2" fill="#f59e0b"/><rect x="14" y="4" width="6" height="6" rx="2" fill="#6366f1"/>
                <rect x="4" y="14" width="6" height="6" rx="2" fill="#22d3ee"/><rect x="14" y="14" width="6" height="6" rx="2" fill="#10b981"/></svg>`;
        }
        function clockIcon() {
            return `<svg width="18" height="18" viewBox="0 0 24 24"><circle cx="12" cy="12" r="9" fill="#e0f2fe" stroke="#0284c7" stroke-width="1.5"/><path d="M12 7v6l4 2" stroke="#0369a1" stroke-width="2" stroke-linecap="round"/></svg>`;
        }
        function dotIcon() {
            return `<svg width="10" height="10"><circle cx="5" cy="5" r="5" fill="#94a3b8"/></svg>`;
        }

        // í‰ê°€ ì‘ì‹œ í˜„í™© ì¹´ë“œ íƒ­ ê¸°ëŠ¥
        document.addEventListener('DOMContentLoaded', function() {
            const evalTabButtons = document.querySelectorAll('.eval-tab-btn');
            const rateElement = document.getElementById('rate');
            const avgElement = document.getElementById('avg');
            const missElement = document.getElementById('miss');
            const dueElement = document.getElementById('due');

            const evalTabData = {
                today: { rate: '70%', avg: '84ì ', miss: '2ê±´', due: '1ê±´' },
                week: { rate: '76%', avg: '86ì ', miss: '3ê±´', due: '1ê±´' },
                all: { rate: '82%', avg: '88ì ', miss: '5ê±´', due: '0ê±´' }
            };

            function setActiveEvalTab(which) {
                evalTabButtons.forEach(btn => {
                    const active = btn.dataset.tab === which;
                    btn.classList.toggle('bg-white', active);
                    btn.classList.toggle('text-teal-700', active);
                    btn.classList.toggle('shadow', active);
                    btn.classList.toggle('text-white/90', !active);
                });

                const data = evalTabData[which];
                if (rateElement) rateElement.textContent = data.rate;
                if (avgElement) avgElement.textContent = data.avg;
                if (missElement) missElement.textContent = data.miss;
                if (dueElement) dueElement.textContent = data.due;
            }

            evalTabButtons.forEach(btn => {
                btn.addEventListener('click', () => setActiveEvalTab(btn.dataset.tab));
            });

            // ì´ˆê¸° íƒ­ ì„¤ì •
            setActiveEvalTab('today');
        });

    </script>



    <!-- Pet Studio ëª¨ë‹¬ íŒì—… (ê°œìˆ˜ ì„¸ê¸° ê²Œì„ê³¼ ë™ì¼í•œ ìŠ¤íƒ€ì¼) -->
    <div id="pet-studio-popup" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-2">
                    <div class="bg-white rounded-2xl shadow-2xl max-w-[95vw] w-full h-[98vh] overflow-hidden relative">
            <!-- ë‹«ê¸° ë²„íŠ¼ - ìš°ì¸¡ ìµœìƒë‹¨ì— ì‘ê²Œ ë°°ì¹˜ -->
            <button onclick="closePetStudio()" class="absolute top-3 right-3 z-10 text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100 transition-colors bg-white shadow-sm">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <div class="h-full overflow-hidden">
                <iframe id="pet-studio-iframe" class="w-full h-full border-0" frameborder="0"></iframe>
            </div>
        </div>
    </div>

    <!-- ê°œìˆ˜ ì„¸ê¸° ê²Œì„ ëª¨ë‹¬ íŒì—… -->
    <div id="counting-game-popup" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-2">
        <div class="bg-white rounded-2xl shadow-2xl max-w-[95vw] w-full h-[98vh] overflow-hidden relative">
            <!-- ë‹«ê¸° ë²„íŠ¼ - ìš°ì¸¡ ìµœìƒë‹¨ì— ì‘ê²Œ ë°°ì¹˜ -->
            <button onclick="closeCountingGame()" class="absolute top-3 right-3 z-10 text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100 transition-colors bg-white shadow-sm">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <div class="h-full overflow-hidden">
                <iframe id="counting-game-iframe" class="w-full h-full border-0" frameborder="0"></iframe>
            </div>
        </div>
    </div>

    <!-- í’ì„  ë§ì…ˆ ê²Œì„ ëª¨ë‹¬ íŒì—… -->
    <div id="balloon-addition-game-popup" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-2">
        <div class="bg-white rounded-2xl shadow-2xl max-w-[95vw] w-full h-[98vh] overflow-hidden relative">
            <!-- ë‹«ê¸° ë²„íŠ¼ - ìš°ì¸¡ ìµœìƒë‹¨ì— ì‘ê²Œ ë°°ì¹˜ -->
            <button onclick="closeBalloonAdditionGame()" class="absolute top-3 right-3 z-10 text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100 transition-colors bg-white shadow-sm">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <div class="h-full overflow-hidden">
                <iframe id="balloon-addition-game-iframe" class="w-full h-full border-0" frameborder="0"></iframe>
            </div>
        </div>
    </div>

    <!-- ê²½ë§¤ íŠœí† ë¦¬ì–¼ ëª¨ë‹¬ íŒì—… -->
    <div id="auction-tutorial-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 relative overflow-hidden">
            <!-- ë‹«ê¸° ë²„íŠ¼ -->
            <button onclick="closeAuctionTutorial()" class="absolute top-3 right-3 z-10 text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100 transition-colors bg-white shadow-sm">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <!-- í—¤ë” -->
            <div class="bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white text-center">
                <div class="text-4xl mb-2">ğŸ”¨</div>
                <h3 class="text-xl font-bold">ê²½ë§¤ íŠœí† ë¦¬ì–¼</h3>
                <p class="text-blue-100 text-sm mt-1">ì´ˆë“±í•™ìƒì„ ìœ„í•œ ê²½ë§¤ ì™„ë²½ ê°€ì´ë“œ</p>
            </div>
            
            <!-- ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ -->
            <div id="tutorial-slides" class="relative">
                <!-- ìŠ¬ë¼ì´ë“œ 1: ê²½ë§¤ë€? -->
                <div class="slide active" data-slide="0">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-blue-600 font-bold text-2xl">1</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">ê²½ë§¤ë€?</h4>
                        </div>
                        <div class="space-y-3 text-center">
                            <p class="text-slate-700">ì›í•˜ëŠ” ì•„ì´í…œì— í•™ìŠµ í¬ì¸íŠ¸ë¥¼ ê±¸ì–´ìš”.</p>
                            <p class="text-slate-700">ê°€ì¥ ë†’ì€ ì‚¬ëŒì´ ê°€ì ¸ê°€ìš”. ì§„ì§œ ëˆì€ ì“°ì§€ ì•Šì•„ìš”.</p>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mt-4">
                            <div class="flex items-center justify-center gap-2 text-blue-700">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                </svg>
                                <span class="font-semibold">ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸</span>
                            </div>
                            <p class="text-sm text-blue-700 mt-2 text-center">í¬ì¸íŠ¸ë¡œë§Œ ê±°ë˜í•˜ëŠ” ì•ˆì „í•œ ê²½ë§¤ì˜ˆìš”!</p>
                        </div>
                    </div>
                </div>

                <!-- ìŠ¬ë¼ì´ë“œ 2: í™”ë©´ ì‚´í´ë³´ê¸° -->
                <div class="slide hidden" data-slide="1">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-green-600 font-bold text-2xl">2</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">í™”ë©´ ì‚´í´ë³´ê¸°</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="flex items-center gap-3 p-3 bg-green-50 rounded-lg">
                                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                    <span class="text-white font-bold text-sm">ğŸ“±</span>
                                </div>
                                <span class="text-slate-700">ì…ì°° +50P, ì¦‰ì‹œêµ¬ë§¤, ì™•ê´€(ìµœê³  ì…ì°°ì), íƒ€ì´ë¨¸ê°€ ë³´ì—¬ìš”.</span>
                            </div>
                            <div class="flex items-center gap-3 p-3 bg-blue-50 rounded-lg">
                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                    <span class="text-white font-bold text-sm">ğŸ¯</span>
                                </div>
                                <span class="text-slate-700">ì•„ì´í…œ ì¹´ë“œì—ëŠ” ì´ë¦„Â·í˜„ì¬ê°€Â·ë‚¨ì€ ì‹œê°„ì´ í‘œì‹œë¼ìš”.</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ìŠ¬ë¼ì´ë“œ 3: ì…ì°°í•˜ê¸° -->
                <div class="slide hidden" data-slide="2">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-purple-600 font-bold text-2xl">3</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">ì…ì°°í•˜ê¸°</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="bg-purple-50 border border-purple-200 rounded-xl p-4">
                                <p class="text-slate-700 text-center mb-3">'ì…ì°° +50P'ë¥¼ ëˆ„ë¥´ë©´ í˜„ì¬ê°€ê°€ 50P ì˜¬ë¼ìš”.</p>
                                <div class="flex items-center justify-center gap-2 text-purple-700">
                                    <span class="font-semibold">ì˜ˆì‹œ:</span>
                                    <span class="bg-white px-3 py-1 rounded-lg border">í˜„ì¬ê°€: 540P</span>
                                    <span class="text-2xl">â†’</span>
                                    <span class="bg-purple-500 text-white px-3 py-1 rounded-lg">590P</span>
                                </div>
                            </div>
                            <p class="text-slate-700 text-center">ë‚™ì°°ë  ë•Œë§Œ í¬ì¸íŠ¸ê°€ ì°¨ê°ë¼ìš”.</p>
                        </div>
                    </div>
                </div>

                <!-- ìŠ¬ë¼ì´ë“œ 4: ì¢…ë£Œ ê·œì¹™ -->
                <div class="slide hidden" data-slide="3">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-orange-600 font-bold text-2xl">4</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">ì¢…ë£Œ ê·œì¹™</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="grid grid-cols-2 gap-3">
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 text-center">
                                    <div class="text-2xl mb-2">â°</div>
                                    <p class="text-sm text-slate-700">íƒ€ì´ë¨¸ 0ì´ˆ</p>
                                </div>
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 text-center">
                                    <div class="text-2xl mb-2">ğŸ’</div>
                                    <p class="text-sm text-slate-700">ì¦‰ì‹œêµ¬ë§¤</p>
                                </div>
                            </div>
                            <p class="text-slate-700 text-center">ë™ì ì´ë©´ ë¨¼ì € ëˆ„ë¥¸ ì‚¬ëŒì´ ìŠ¹ë¦¬í•´ìš”.</p>
                        </div>
                    </div>
                </div>

                <!-- ìŠ¬ë¼ì´ë“œ 5: ë˜‘ë˜‘í•œ íŒ -->
                <div class="slide hidden" data-slide="4">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-yellow-600 font-bold text-2xl">5</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">ë˜‘ë˜‘í•œ íŒ</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                <p class="text-slate-700 text-center">ì˜ˆì‚°ì„ ì •í•˜ê³  ì…ì°°í•´ìš”(ì˜ˆ: ì˜¤ëŠ˜ì€ 1000P).</p>
                            </div>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                <p class="text-slate-700 text-center">ë§ˆì§€ë§‰ 10ì´ˆì— ê²½ìŸì´ ì¹˜ì—´í•´ìš”. ì™•ê´€ ìœ ì§€ í™•ì¸!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ìŠ¬ë¼ì´ë“œ 6: ì˜ˆì ˆ ì§€í‚¤ê¸° -->
                <div class="slide hidden" data-slide="5">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-red-600 font-bold text-2xl">6</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">ì˜ˆì ˆ ì§€í‚¤ê¸°</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                <p class="text-slate-700 text-center">ë„ë°°Â·ë°©í•´ëŠ” ê¸ˆì§€, ë¬¸ì œê°€ ìˆìœ¼ë©´ ì‹ ê³ í•´ìš”.</p>
                            </div>
                            <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                <p class="text-slate-700 text-center">ì§€ë©´ 'ì¶•í•˜í•´!'ë¼ê³  ë§í•´ìš”. ëª¨ë‘ ê¸°ë¶„ ì¢‹ì•„ì ¸ìš”.</p>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-4 mt-4">
                            <div class="flex items-center justify-center gap-2 text-indigo-700">
                                <span class="font-semibold">ğŸ¯ ë‹¤ìŒ ë‹¨ê³„</span>
                            </div>
                            <p class="text-sm text-indigo-700 mt-2 text-center">ì´ì œ í€´ì¦ˆë¥¼ í’€ì–´ì„œ ê²½ë§¤ë¥¼ ì™„ë²½í•˜ê²Œ ì´í•´í•´ë³´ì„¸ìš”!</p>
                        </div>
                    </div>
                </div>

                <!-- í€´ì¦ˆ ìŠ¬ë¼ì´ë“œë“¤ -->
                <div class="slide hidden" data-slide="6">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-indigo-600 font-bold text-2xl">?</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">í€´ì¦ˆ 1/3</h4>
                        </div>
                        <div class="space-y-4">
                            <p class="text-slate-700 text-center text-lg">í˜„ì¬ê°€ 540Pì¼ ë•Œ 'ì…ì°° +50P'ë¥¼ ëˆ„ë¥´ë©´ ì–¼ë§ˆê°€ ë˜ë‚˜ìš”?</p>
                            <div class="grid grid-cols-2 gap-3" id="quiz-choices-1">
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(1, 0, 1)">560P</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(1, 1, 1)">590P</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(1, 2, 1)">600P</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(1, 3, 1)">640P</button>
                            </div>
                            <div id="quiz-result-1" class="hidden">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
                                    <p class="text-green-700 font-semibold">ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰</p>
                                    <p class="text-green-600 text-sm mt-1">'ì…ì°° +50P'ëŠ” í˜„ì¬ê°€ì— 50ì„ ë”í•©ë‹ˆë‹¤.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="slide hidden" data-slide="7">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-indigo-600 font-bold text-2xl">?</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">í€´ì¦ˆ 2/3</h4>
                        </div>
                        <div class="space-y-4">
                            <p class="text-slate-700 text-center text-lg">ê°™ì€ ê°€ê²©ì´ë©´ ëˆ„ê°€ ì´ê¸°ë‚˜ìš”?</p>
                            <div class="grid grid-cols-2 gap-3" id="quiz-choices-2">
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(2, 0, 1)">ë‚˜ì¤‘ì— ëˆ„ë¥¸ ì‚¬ëŒ</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(2, 1, 1)">ë¨¼ì € ëˆ„ë¥¸ ì‚¬ëŒ</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(2, 2, 1)">ë¬´ì‘ìœ„ ì¶”ì²¨</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(2, 3, 1)">ì‹œê°„ì´ ë” ë‚¨ì€ ì‚¬ëŒ</button>
                            </div>
                            <div id="quiz-result-2" class="hidden">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
                                    <p class="text-green-700 font-semibold">ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰</p>
                                    <p class="text-green-600 text-sm mt-1">ë™ì ì¼ ë•ŒëŠ” ë¨¼ì € ì…ì°°í•œ ì°¸ê°€ìê°€ ìŠ¹ë¦¬í•©ë‹ˆë‹¤.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="slide hidden" data-slide="8">
                    <div class="p-6 space-y-4">
                        <div class="text-center mb-6">
                            <div class="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-indigo-600 font-bold text-2xl">?</span>
                            </div>
                            <h4 class="text-lg font-bold text-slate-800">í€´ì¦ˆ 3/3</h4>
                        </div>
                        <div class="space-y-4">
                            <p class="text-slate-700 text-center text-lg">í¬ì¸íŠ¸ëŠ” ì–¸ì œ ì°¨ê°ë˜ë‚˜ìš”?</p>
                            <div class="grid grid-cols-2 gap-3" id="quiz-choices-3">
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(3, 0, 1)">ì…ì°°í•  ë•Œë§ˆë‹¤</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(3, 1, 1)">ë‚´ê°€ ë‚™ì°°ë  ë•Œ</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(3, 2, 1)">ê²½ë§¤ ì‹œì‘í•  ë•Œ</button>
                                <button class="quiz-choice p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg border transition-colors" onclick="handleQuizChoice(3, 3, 1)">ê²½ë§¤ ì—°ì¥ë  ë•Œ</button>
                            </div>
                            <div id="quiz-result-3" class="hidden">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
                                    <p class="text-green-700 font-semibold">ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰</p>
                                    <p class="text-green-600 text-sm mt-1">ë‚´ê°€ ë‚™ì°°ëœ ê²½ìš°ì—ë§Œ ì‹¤ì œ í¬ì¸íŠ¸ê°€ ì°¨ê°ë©ë‹ˆë‹¤.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì™„ë£Œ ìŠ¬ë¼ì´ë“œ -->
                <div class="slide hidden" data-slide="9">
                    <div class="p-6 space-y-4 text-center">
                        <div class="w-20 h-20 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-3xl">ğŸ‰</span>
                        </div>
                        <h4 class="text-xl font-bold text-slate-800">íŠœí† ë¦¬ì–¼ ì™„ë£Œ!</h4>
                        <p class="text-slate-600">ì´ì œ ê²½ë§¤ë¥¼ ììœ ë¡­ê²Œ ì¦ê¸¸ ìˆ˜ ìˆì–´ìš”!</p>
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl p-4 mt-4">
                            <p class="text-green-700 font-semibold">ğŸ’¡ ë‹¤ìŒ ë‹¨ê³„</p>
                            <p class="text-green-600 text-sm mt-1">ì‹¤ì œ ê²½ë§¤ì— ì°¸ì—¬í•´ì„œ ì—°ìŠµí•´ë³´ì„¸ìš”!</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="bg-gray-50 px-6 py-4">
                <!-- í˜ì´ì§€ ì¸ë””ì¼€ì´í„° (ë„íŠ¸) -->
                <div class="flex justify-center mb-3">
                    <div class="flex space-x-2" id="page-indicators">
                        <div class="w-2 h-2 bg-blue-400 rounded-full active"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
                    </div>
                </div>
                
                <!-- ë²„íŠ¼ ì˜ì—­ -->
                <div class="flex justify-between items-center">
                    <button id="prev-btn" onclick="prevSlide()" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        ì´ì „
                    </button>
                    
                    <button id="next-btn" onclick="nextSlide()" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-2 rounded-lg font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-200">
                        ë‹¤ìŒ
                    </button>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 